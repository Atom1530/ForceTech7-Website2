{"version":3,"file":"index.js","sources":["../src/js/api.js","../src/js/artists/lib/sound.js","../src/js/artists/features/api.js","../src/js/artists/features/state.js","../src/js/artists/lib/scroll-lock.js","../src/js/artists/features/player.js","../src/js/artists/features/zoom.js","../src/js/artists/features/modal.js","../src/img/sprite.svg?url","../src/js/shared/sprite.js","../src/js/artists/features/grid.js","../src/js/artists/features/router.js","../src/js/artists/features/prefetch.js","../src/js/artists/features/init.js","../src/js/artists/index.js","../src/js/header.js","../src/js/comments.js","../src/js/global-sfx.js"],"sourcesContent":["import axios from \"axios\";\n\n/* ===== Env & logging ===== */\nconst IS_DEV =\n  /localhost|127\\.0\\.0\\.1/.test(location.hostname) ||\n  (document.documentElement.getAttribute(\"data-env\") || \"\").toLowerCase() === \"dev\";\n\nconst logWarn = (...args) => {\n  if (IS_DEV) console.warn(...args);\n};\n\n/* ===== Axios ===== */\nconst api = axios.create({\n  baseURL: \"https://sound-wave.b.goit.study/api\",\n  timeout: 15000,\n});\n\n/* ===== API ===== */\nexport async function fetchArtists(\n  { page = 1, limit = 8, genre = \"\", sort = \"\", name = \"\" } = {}\n) {\n  try {\n    const params = {\n      page: Math.max(1, Number(page) || 1),\n      limit: Math.max(1, Number(limit) || 8),\n    };\n\n    const s = String(sort).toLowerCase();\n    if (s === \"asc\" || s === \"desc\") params.sortName = s;\n\n    const g = String(genre).trim();\n    if (g && g !== \"All Genres\") params.genre = g;\n\n    const n = String(name).trim();\n    if (n.length >= 1) params.name = n;\n\n    const { data } = await api.get(\"/artists\", { params });\n    return {\n      artists: Array.isArray(data?.artists) ? data.artists : [],\n      totalArtists: Number(data?.totalArtists || 0),\n      page: Number(data?.page || params.page),\n      limit: Number(data?.limit || params.limit),\n    };\n  } catch (err) {\n    logWarn(\"[api] fetchArtists\", err?.message || err);\n    try { window.__toast?.error(\"Не удалось загрузить артистов. Попробуйте позже.\"); } catch {}\n    return { artists: [], totalArtists: 0, page: 1, limit };\n  }\n}\n\nexport async function fetchGenres() {\n  try {\n    const { data } = await api.get(\"/genres\");\n    const raw = Array.isArray(data) ? data : (data?.genres || []);\n    const names = raw\n      .map((g) =>\n        typeof g === \"string\"\n          ? g\n          : g?.name || g?.title || g?.genre || g?.label || \"\"\n      )\n      .filter(Boolean);\n    const uniq = [...new Set(names)];\n    return [\"All Genres\", ...uniq];\n  } catch (err) {\n    logWarn(\"[api] fetchGenres\", err?.message || err);\n    try { window.__toast?.error(\"Не удалось загрузить жанры.\"); } catch {}\n    return [\"All Genres\"];\n  }\n}\n\nexport async function fetchArtist(id) {\n  try {\n    const { data } = await api.get(`/artists/${id}`);\n    return data || null;\n  } catch (err) {\n    logWarn(\"[api] fetchArtist\", err?.message || err);\n    try { window.__toast?.error(\"Не удалось загрузить артиста.\"); } catch {}\n    return null;\n  }\n}\n\nexport async function fetchArtistAlbums(id) {\n  try {\n    const { data } = await api.get(`/artists/${id}/albums`);\n\n    if (Array.isArray(data)) return data;\n    if (Array.isArray(data?.albumsList)) return data.albumsList;\n    if (Array.isArray(data?.albums)) return data.albums;\n\n    return [];\n  } catch (err) {\n    logWarn(\"[api] albums\", err?.message || err);\n    try { window.__toast?.error(\"Не удалось загрузить альбомы.\"); } catch {}\n    return [];\n  }\n}\n","\n// Мягкий «клац» (tap) и чуть иной звук для пагинации (page)\nlet ctx, master, comp, postLP;\nlet inited = false;\n\nfunction init() {\n  if (inited) return;\n  const AC = window.AudioContext || window.webkitAudioContext;\n  if (!AC) return;\n  ctx = new AC();\n\n  comp = ctx.createDynamicsCompressor();\n  comp.threshold.value = -26;\n  comp.knee.value = 22;\n  comp.ratio.value = 6;\n  comp.attack.value = 0.004;\n  comp.release.value = 0.08;\n\n  postLP = ctx.createBiquadFilter();\n  postLP.type = \"lowpass\";\n  postLP.frequency.value = 2300;\n  postLP.Q.value = 0.6;\n\n  master = ctx.createGain();\n  master.gain.value = 0.11;\n\n  master.connect(postLP);\n  postLP.connect(comp);\n  comp.connect(ctx.destination);\n\n  // Разблокировка на первом жесте\n  const unlock = () => {\n    try { ctx.resume(); } catch {}\n    window.removeEventListener(\"pointerdown\", unlock);\n    window.removeEventListener(\"keydown\", unlock);\n    window.removeEventListener(\"touchstart\", unlock);\n  };\n  window.addEventListener(\"pointerdown\", unlock, { once: true, passive: true });\n  window.addEventListener(\"keydown\", unlock, { once: true });\n  window.addEventListener(\"touchstart\", unlock, { once: true, passive: true });\n\n  inited = true;\n}\n\nfunction resume() { if (ctx && ctx.state === \"suspended\") ctx.resume(); }\n\nfunction tap() {\n  if (!inited) init();\n  if (!ctx) return;\n  resume();\n  const now = ctx.currentTime + 0.004;\n\n  // шумовой щелчок\n  const durNoise = 0.055;\n  const nsrc = ctx.createBufferSource();\n  const nbuf = ctx.createBuffer(1, Math.max(32, (ctx.sampleRate * durNoise) | 0), ctx.sampleRate);\n  const ch = nbuf.getChannelData(0);\n  for (let i = 0; i < ch.length; i++) {\n    const t = i / ch.length;\n    ch[i] = (Math.random() * 2 - 1) * Math.pow(1 - t, 2);\n  }\n  nsrc.buffer = nbuf;\n\n  const bp = ctx.createBiquadFilter();\n  bp.type = \"bandpass\"; bp.frequency.value = 2050; bp.Q.value = 0.9;\n  const hp = ctx.createBiquadFilter();\n  hp.type = \"highpass\"; hp.frequency.value = 360; hp.Q.value = 0.7;\n\n  const ng = ctx.createGain();\n  ng.gain.setValueAtTime(0.0001, now);\n  ng.gain.linearRampToValueAtTime(0.45, now + 0.004);\n  ng.gain.exponentialRampToValueAtTime(0.0001, now + 0.055);\n\n  nsrc.connect(bp); bp.connect(hp); hp.connect(ng); ng.connect(master);\n  nsrc.start(now); nsrc.stop(now + 0.06);\n\n  // лёгкий верхний обертон\n  const osc = ctx.createOscillator();\n  osc.type = \"triangle\"; osc.frequency.setValueAtTime(2100, now);\n  const og = ctx.createGain();\n  og.gain.setValueAtTime(0.0001, now);\n  og.gain.linearRampToValueAtTime(0.20, now + 0.003);\n  og.gain.exponentialRampToValueAtTime(0.0001, now + 0.05);\n  osc.connect(og); og.connect(master);\n  osc.start(now); osc.stop(now + 0.055);\n\n  // чуть «тела»\n  const low = ctx.createOscillator();\n  low.type = \"sine\"; low.frequency.setValueAtTime(165, now);\n  const lg = ctx.createGain();\n  lg.gain.setValueAtTime(0.0001, now);\n  lg.gain.linearRampToValueAtTime(0.05, now + 0.003);\n  lg.gain.exponentialRampToValueAtTime(0.0001, now + 0.042);\n  low.connect(lg); lg.connect(master);\n  low.start(now); low.stop(now + 0.045);\n}\n\nfunction page() {\n  if (!inited) init();\n  if (!ctx) return;\n  resume();\n  const now = ctx.currentTime + 0.003;\n  const osc = ctx.createOscillator();\n  osc.type = \"triangle\"; osc.frequency.setValueAtTime(1750, now);\n  const g = ctx.createGain();\n  g.gain.setValueAtTime(0.0001, now);\n  g.gain.linearRampToValueAtTime(0.17, now + 0.003);\n  g.gain.exponentialRampToValueAtTime(0.0001, now + 0.06);\n  osc.connect(g); g.connect(master);\n  osc.start(now); osc.stop(now + 0.065);\n}\n\nexport const UISound = { tap, page };\nexport default UISound;\n","\nimport {\n  fetchArtists as _fetchArtists,\n  fetchGenres  as _fetchGenres,\n  fetchArtist  as _fetchArtist,\n  fetchArtistAlbums as _fetchArtistAlbums,\n} from \"../../api.js\";\n\n// ---------- helpers ----------\nconst normId = (o) => o?.idArtist || o?.id || o?._id || o?.artistId || \"\";\n\nconst normGenres = (o) => {\n  if (Array.isArray(o?.genres)) return o.genres;\n  if (typeof o?.strGenre === \"string\" && o.strGenre.trim())\n    return o.strGenre.split(/,\\s*/).filter(Boolean);\n  if (o?.genre) return [o.genre];\n  return [];\n};\n\nconst NOPHOTO = \"https://via.placeholder.com/960x540?text=No+Image\";\n\nconst normArtist = (o = {}) => ({\n  id: normId(o),\n  name: o.strArtist || o.name || \"Unknown artist\",\n  image: o.strArtistThumb || o.thumb || o.photo || o.image || NOPHOTO,\n  country: o.strCountry || o.country || \"N/A\",\n  members: o.intMembers || o.members || \"N/A\",\n  gender:  o.strGender || o.sex || \"N/A\",\n  biography: o.strBiographyEN || o.biography || o.about || \"\",\n  genres: normGenres(o),\n  formedYear: o.intFormedYear || o.formedYear || o.yearStart || null,\n  endedYear:  o.intDisbandedYear || o.intDiedYear || o.disbandedYear || o.yearEnd || null,\n});\n\nconst normTrack = (t = {}) => ({\n  title: t.strTrack || t.title || t.name || \"—\",\n  duration: Number(t.intDuration ?? t.duration ?? t.time ?? 0),\n  youtube: t.strMusicVid || t.youtube || t.youtube_url || t.url || t.movie || \"\",\n});\n\nconst normAlbum = (a = {}) => {\n  const rawTracks =\n    Array.isArray(a.tracks) ? a.tracks :\n    Array.isArray(a.songs)  ? a.songs  :\n    Array.isArray(a.track)  ? a.track  : [];\n  return {\n    title: a.strAlbum || a.title || a.name || \"Album\",\n    tracks: rawTracks.map(normTrack),\n  };\n};\n\n// ---------- exported API (normalized) ----------\nexport async function fetchArtists(params) {\n  const res = await _fetchArtists(params);\n  const list = Array.isArray(res?.artists) ? res.artists\n             : Array.isArray(res)          ? res\n             : [];\n  const artists = list.map(normArtist);\n  const totalArtists = Number(res?.totalArtists ?? res?.total ?? artists.length);\n  return { artists, totalArtists };\n}\n\nexport async function fetchGenres() {\n  const res = await _fetchGenres();\n  if (Array.isArray(res)) return res;\n  if (Array.isArray(res?.genres)) return res.genres;\n  return [];\n}\n\nexport async function fetchArtist(id) {\n  const res = await _fetchArtist(id);\n  const obj = Array.isArray(res) ? res[0]\n            : Array.isArray(res?.artists) ? res.artists[0]\n            : res;\n  return obj ? normArtist(obj) : null;\n}\n\nexport async function fetchArtistAlbums(id) {\n  const res = await _fetchArtistAlbums(id);\n  const list = Array.isArray(res) ? res\n             : Array.isArray(res?.albums) ? res.albums\n             : Array.isArray(res?.album)  ? res.album\n             : [];\n  return list.map(normAlbum);\n}\n\n\n\n","// src/js/artists/features/state.js\n\nconst STORAGE_KEY = \"artistsStateV2\";\n\nconst initial = {\n  page: 1,\n  limit: 8,            // базовый лимит для Default\n  genre: \"\",\n  sort: \"\",\n  q: \"\",\n  isMobilePanelOpen: false,\n};\n\n// Текущее состояние\nlet state = { ...initial };\n\n// Флаг и слушатели\nlet storageLoaded = false;\nconst listeners = new Set();\n\n/* ---------------- storage helpers ---------------- */\nfunction canUseStorage() {\n  try {\n    const k = \"__probe__\";\n    localStorage.setItem(k, \"1\");\n    localStorage.removeItem(k);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\nfunction loadFromStorage() {\n  if (storageLoaded) return;\n  storageLoaded = true;\n  if (!canUseStorage()) return;\n\n  try {\n    const raw = localStorage.getItem(STORAGE_KEY);\n    if (!raw) return;\n    const obj = JSON.parse(raw);\n    state = {\n      page: Math.max(1, Number(obj?.page) || initial.page),\n      limit: Math.max(1, Number(obj?.limit) || initial.limit),\n      genre: String(obj?.genre ?? initial.genre),\n      sort: String(obj?.sort ?? initial.sort),\n      q: String(obj?.q ?? initial.q),\n      isMobilePanelOpen: !!obj?.isMobilePanelOpen,\n    };\n  } catch {\n    // игнор\n  }\n}\n\nfunction saveToStorage() {\n  if (!storageLoaded || !canUseStorage()) return;\n  try {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));\n  } catch {\n    // квота/приватный режим — молча\n  }\n}\n\n/* ---------------- pub/sub ---------------- */\nfunction notify() {\n  const snap = { ...state };\n  for (const fn of listeners) {\n    try { fn(snap); } catch {}\n  }\n}\n\n/** Подписка на изменения состояния. Возвращает функцию отписки. */\nexport function subscribe(fn) {\n  if (typeof fn !== \"function\") return () => {};\n  listeners.add(fn);\n  return () => listeners.delete(fn);\n}\n\n/** Явная отписка (альтернатива функции, возвращаемой subscribe) */\nexport function unsubscribe(fn) {\n  listeners.delete(fn);\n}\n\n// на всякий случай алиас, если где-то импортируется другое имя\nexport const onChange = subscribe;\n\n/* ---------------- современный API ---------------- */\nconst ArtistState = {\n  get() {\n    loadFromStorage();\n    return { ...state };\n  },\n  setPage(p) {\n    loadFromStorage();\n    state.page = Math.max(1, Number(p) || 1);\n    saveToStorage(); notify();\n  },\n  setLimit(n) {\n    loadFromStorage();\n    state.limit = Math.max(1, Number(n) || initial.limit);\n    saveToStorage(); notify();\n  },\n  setGenre(v) {\n    loadFromStorage();\n    state.genre = v || \"\";\n    saveToStorage(); notify();\n  },\n  setSort(v) {\n    loadFromStorage();\n    state.sort = v || \"\";\n    saveToStorage(); notify();\n  },\n  setQuery(v) {\n    loadFromStorage();\n    state.q = v || \"\";\n    saveToStorage(); notify();\n  },\n  setMobilePanel(on) {\n    loadFromStorage();\n    state.isMobilePanelOpen = !!on;\n    saveToStorage(); notify();\n  },\n  reset() {\n    loadFromStorage();\n    state = { ...initial };\n    saveToStorage(); notify();\n  },\n};\n\nexport { ArtistState };\nexport default ArtistState;\n\n/* ---------------- back-compat экспорт ---------------- */\n// Старые импорты могли использовать эти функции.\nexport const getState = () => ArtistState.get();\n\nexport const setState = (patch = {}) => {\n  loadFromStorage();\n  const next = { ...state };\n\n  if (\"page\" in patch)  next.page  = Math.max(1, Number(patch.page)  || 1);\n  if (\"limit\" in patch) next.limit = Math.max(1, Number(patch.limit) || initial.limit);\n  if (\"genre\" in patch) next.genre = String(patch.genre || \"\");\n  if (\"sort\" in patch)  next.sort  = String(patch.sort  || \"\");\n  if (\"q\" in patch)     next.q     = String(patch.q     || \"\");\n  if (\"isMobilePanelOpen\" in patch) next.isMobilePanelOpen = !!patch.isMobilePanelOpen;\n\n  state = next;\n  saveToStorage(); notify();\n  return ArtistState.get();\n};\n\nexport const resetState = () => { ArtistState.reset(); return ArtistState.get(); };\n\n// Пробрасываем поименованные сеттеры, если где-то импортируются напрямую\nexport const setPage        = (p)  => ArtistState.setPage(p);\nexport const setLimit       = (n)  => ArtistState.setLimit(n);\nexport const setGenre       = (v)  => ArtistState.setGenre(v);\nexport const setSort        = (v)  => ArtistState.setSort(v);\nexport const setQuery       = (v)  => ArtistState.setQuery(v);\nexport const setMobilePanel = (on) => ArtistState.setMobilePanel(on);\n\n/* ---------------- первичная загрузка ---------------- */\nloadFromStorage(); // чтобы состояние было готово до первых подписок\n\n\n","// Реф-счётчик + «аварийная» разблокировка\nlet depth = 0;\nlet savedY = 0;\n\nexport function lockScroll() {\n  if (depth++ === 0) {\n    savedY = window.scrollY || document.documentElement.scrollTop || 0;\n    const s = document.body.style;\n    s.position = \"fixed\";\n    s.top = `-${savedY}px`;\n    s.left = \"0\";\n    s.right = \"0\";\n    s.width = \"100%\";\n    document.body.classList.add(\"scroll-locked\");\n  }\n}\n\nexport function unlockScroll(force = false) {\n  if (force) depth = 1;                // принудительно «свести» к нулю\n  if (depth > 0 && --depth === 0) {\n    const s = document.body.style;\n    s.position = s.top = s.left = s.right = s.width = \"\";\n    window.scrollTo(0, savedY);\n    document.body.classList.remove(\"scroll-locked\");\n  }\n}\n\n// на всякий случай — доступно из консоли: window.__unlockScroll()\nexport function emergencyUnlock() { unlockScroll(true); }\nif (typeof window !== \"undefined\") {\n  window.__unlockScroll = emergencyUnlock;\n  // если страница перегружается в зафиксированном состоянии — снимем блокировку\n  window.addEventListener(\"pageshow\", () => emergencyUnlock());\n}\n","\n\nlet _instance = null;\n\n/* -------------------- YT API -------------------- */\nfunction loadYTAPI() {\n  if (window.YT && window.YT.Player) return Promise.resolve();\n  if (loadYTAPI._p) return loadYTAPI._p;\n  loadYTAPI._p = new Promise((res, rej) => {\n    const s = document.createElement(\"script\");\n    s.src = \"https://www.youtube.com/iframe_api\";\n    s.onerror = () => rej(new Error(\"YT API load failed\"));\n    document.head.appendChild(s);\n    const t = setTimeout(() => rej(new Error(\"YT API timeout\")), 15000);\n    window.onYouTubeIframeAPIReady = () => { clearTimeout(t); res(); };\n  });\n  return loadYTAPI._p;\n}\n\nconst isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);\nfunction getYouTubeId(urlOrId) {\n  if (!urlOrId) return \"\";\n  if (/^[\\w-]{11}$/.test(urlOrId)) return urlOrId;\n  try {\n    const u = new URL(urlOrId);\n    if (/youtu\\.be$/.test(u.hostname)) return u.pathname.slice(1);\n    if (u.searchParams.get(\"v\")) return u.searchParams.get(\"v\");\n    const m = u.pathname.match(/\\/(embed|shorts|v)\\/([^/?#]+)/);\n    return m ? m[2] : \"\";\n  } catch { return \"\"; }\n}\nconst clamp = (v, a, b) => Math.min(b, Math.max(a, v));\nconst shuffleArr = (arr) => {\n  const a = arr.slice();\n  for (let i = a.length - 1; i > 0; i--) {\n    const j = (Math.random() * (i + 1)) | 0;\n    [a[i], a[j]] = [a[j], a[i]];\n  }\n  return a;\n};\nfunction fmtTimeSec(sec) {\n  sec = Math.max(0, Math.round(Number(sec) || 0));\n  const m = Math.floor(sec / 60);\n  const s = String(sec % 60).padStart(2, \"0\");\n  return `${m}:${s}`;\n}\n\n/* -------------------- Экспорт: фабрика singleton -------------------- */\nexport function createMiniPlayer() {\n  if (_instance) return _instance;\n\n  /* ---------- DOM ---------- */\n  const dock = document.createElement(\"div\");\n  dock.className = \"am-player\";\n  dock.innerHTML = `\n    <div class=\"am-player__inner\">\n      <div class=\"am-player__dragzone\" aria-hidden=\"true\" title=\"Drag the player\"></div>\n\n      <!-- Верхние кнопки: Hide слева от Close -->\n      <button class=\"am-player__hide\" type=\"button\" aria-label=\"Hide\">Hide</button>\n      <button class=\"am-player__close\" type=\"button\" aria-label=\"Close\">×</button>\n\n      <div class=\"am-player__frame\">\n        <div class=\"am-player__host\" id=\"am-player-host\"></div>\n        <!-- наша кнопка YouTube поверх кадра, влево-вверх -->\n        <a class=\"am-player__ytlink\" href=\"#\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Open on YouTube\">YouTube ↗</a>\n      </div>\n\n      <div class=\"am-player__bar\">\n        <div class=\"am-player__left\">\n          <button class=\"am-player__skip am-player__prev\" type=\"button\" aria-label=\"Previous\">⏮</button>\n          <button class=\"am-player__play\" type=\"button\" aria-label=\"Play/Pause\">▶</button>\n          <button class=\"am-player__skip am-player__next\" type=\"button\" aria-label=\"Next\">⏭</button>\n          <span class=\"am-player__time\"><span class=\"am-player__cur\">0:00</span> / <span class=\"am-player__dur\">0:00</span></span>\n        </div>\n\n        <div class=\"am-player__progresswrap\">\n          <input class=\"am-player__progress\" type=\"range\" min=\"0\" max=\"1000\" value=\"0\" step=\"1\" aria-label=\"Seek\">\n        </div>\n\n        <div class=\"am-player__right\">\n          <button class=\"am-player__mute\" type=\"button\" aria-label=\"Mute/Unmute\">🔈</button>\n          <input class=\"am-player__slider\" type=\"range\" min=\"0\" max=\"100\" value=\"60\" step=\"1\" aria-label=\"Volume\">\n        </div>\n      </div>\n    </div>\n  `;\n  document.body.appendChild(dock);\n\n  // плавающий пузырь создаём по требованию\n  let bubble = null;\n\n  // refs\n  const host     = dock.querySelector(\"#am-player-host\");\n  const btnClose = dock.querySelector(\".am-player__close\");\n  const btnHide  = dock.querySelector(\".am-player__hide\");\n  const btnPlay  = dock.querySelector(\".am-player__play\");\n  const btnPrev  = dock.querySelector(\".am-player__prev\");\n  const btnNext  = dock.querySelector(\".am-player__next\");\n  const btnMute  = dock.querySelector(\".am-player__mute\");\n  const vol      = dock.querySelector(\".am-player__slider\");\n  const prog     = dock.querySelector(\".am-player__progress\");\n  const tCur     = dock.querySelector(\".am-player__cur\");\n  const tDur     = dock.querySelector(\".am-player__dur\");\n  const dragzone = dock.querySelector(\".am-player__dragzone\");\n  const aYTlink  = dock.querySelector(\".am-player__ytlink\");\n\n  /* ---------- state ---------- */\n  let yt = null;\n  let ready = false;\n  let duration = 0;\n  let timer = null;\n  let muted = false;\n  let volVal = 60;\n  let userSeeking = false;\n\n  // очередь\n  let queue = [];\n  let qi = -1;\n  let loop = false;\n\n  // позиция дока (free mode)\n  const DOCK_KEY = \"amPlayerPos\";\n  let dockDrag = null;\n\n  // позиция пузыря\n  const BUBBLE_KEY = \"amBubblePos2\";\n  let bubbleDragging = false;\n  let bubbleStart = null;\n  let _bubblePos = null;\n\n  // watchdog (если видео не стартовало)\n  let watchdogId = null;\n\n  if (isIOS) {\n    vol.disabled = true;\n    vol.title = \"On iOS the volume is hardware-only\";\n  }\n\n  /* ---------- UI helpers ---------- */\n  function uiShow(on) {\n    dock.classList.toggle(\"am-player--active\", !!on);\n    if (on) hideBubble();\n  }\n  function uiMin(on) {\n    dock.classList.toggle(\"am-player--min\", !!on);\n    if (on) showBubble(true);\n    else hideBubble();\n  }\n  function uiPlayIcon(isPlaying) { btnPlay.textContent = isPlaying ? \"⏸\" : \"▶\"; }\n  function uiMuteIcon(isMuted) { btnMute.textContent = isMuted ? \"🔇\" : \"🔈\"; }\n  function uiSetTime(cur, dur) {\n    tCur.textContent = fmtTimeSec(cur);\n    tDur.textContent = fmtTimeSec(dur);\n    if (!userSeeking) {\n      const v = dur > 0 ? Math.round((cur / dur) * 1000) : 0;\n      prog.value = String(v);\n    }\n  }\n  function clearTimer() { if (timer) { clearInterval(timer); timer = null; } }\n  function startTimer() {\n    clearTimer();\n    timer = setInterval(() => {\n      if (!ready || !yt || typeof yt.getCurrentTime !== \"function\") return;\n      const cur = yt.getCurrentTime() || 0;\n      const dur = duration || yt.getDuration() || 0;\n      duration = dur;\n      uiSetTime(cur, dur);\n    }, 250);\n  }\n  function clearWatchdog() {\n    if (watchdogId) { clearTimeout(watchdogId); watchdogId = null; }\n  }\n\n  /* ---------- YT ---------- */\n  function skipWithDelay(ms = 2000) { setTimeout(autoNext, ms); }\n\n  function ensureYT(id) {\n    return loadYTAPI().then(() => {\n      if (yt) { try { yt.destroy(); } catch {} yt = null; }\n      host.innerHTML = `<div id=\"am-player-yt\"></div>`;\n      yt = new YT.Player(\"am-player-yt\", {\n        host: \"https://www.youtube-nocookie.com\",\n        videoId: id,\n        playerVars: {\n          autoplay: 1, rel: 0, modestbranding: 1, controls: 1, enablejsapi: 1, origin: location.origin\n        },\n        events: {\n          onReady: () => {\n            ready = true;\n            duration = yt.getDuration() || 0;\n            uiSetTime(0, duration);\n            if (!isIOS && typeof yt.setVolume === \"function\") yt.setVolume(volVal);\n            if (muted && yt.mute) yt.mute();\n            uiPlayIcon(true);\n            setBubblePulse(true);\n            setBubbleAmp(volVal);\n            startTimer();\n\n            clearWatchdog();\n            // если за 6с не ушло в PLAYING — скипаем\n            watchdogId = setTimeout(() => {\n              try {\n                if (yt && yt.getPlayerState && yt.getPlayerState() !== YT.PlayerState.PLAYING) {\n                  console.warn(\"Watchdog: видео не стартовало — пропускаем.\");\n                  setBubblePulse(false);\n                  skipWithDelay(0);\n                }\n              } catch {}\n            }, 6000);\n          },\n          onStateChange: (e) => {\n            if (e.data === YT.PlayerState.PLAYING) {\n              clearWatchdog();\n              uiPlayIcon(true);\n              setBubblePulse(true);\n              startTimer();\n            } else if (e.data === YT.PlayerState.PAUSED) {\n              uiPlayIcon(false);\n              setBubblePulse(false);\n              clearTimer();\n            } else if (e.data === YT.PlayerState.ENDED) {\n              uiPlayIcon(false);\n              setBubblePulse(false);\n              clearTimer();\n              clearWatchdog();\n              autoNext();\n            }\n          },\n          onError: (e) => {\n            console.error(\"YT Player error:\", e?.data);\n            uiPlayIcon(false);\n            setBubblePulse(false);\n            clearTimer();\n            clearWatchdog();\n            skipWithDelay(1200);\n          }\n        }\n      });\n    });\n  }\n\n  /* ---------- Очередь ---------- */\n  async function playByIndex(idx) {\n    if (!queue.length) return;\n    qi = clamp(idx, 0, queue.length - 1);\n    const id = queue[qi];\n    if (!id || !/^[\\w-]{11}$/.test(id)) {\n      console.warn(\"Некорректный YouTube ID, пропускаю:\", id);\n      return skipWithDelay(0);\n    }\n    // обновим ссылку «YouTube ↗»\n    aYTlink.href = `https://www.youtube.com/watch?v=${id}`;\n\n    uiShow(true);\n    ready = false; duration = 0; clearTimer(); clearWatchdog();\n\n    try {\n      await ensureYT(id);\n    } catch (err) {\n      console.error(\"Не удалось воспроизвести:\", id, err);\n      skipWithDelay(1200);\n    }\n  }\n  function autoNext() {\n    if (!queue.length) return;\n    if (qi < queue.length - 1) playByIndex(qi + 1);\n    else if (loop) playByIndex(0);\n  }\n\n  /* ---------- Перетаскивание ДОКА ---------- */\n  function getVP() {\n    const w = window.visualViewport?.width || document.documentElement.clientWidth || window.innerWidth;\n    const h = window.visualViewport?.height || document.documentElement.clientHeight || window.innerHeight;\n    return { w, h };\n  }\n  function clampDock() {\n    if (!dock.classList.contains(\"am-player--free\")) return;\n    const rect = dock.getBoundingClientRect();\n    const { w, h } = getVP();\n    let left = clamp(rect.left, 8, Math.max(8, w - rect.width - 8));\n    let top  = clamp(rect.top,  8, Math.max(8, h - rect.height - 8));\n    dock.style.left = `${left}px`;\n    dock.style.top  = `${top}px`;\n    try { localStorage.setItem(DOCK_KEY, JSON.stringify({ left, top })); } catch {}\n  }\n  function restoreDockPos() {\n    let pos = null;\n    try { pos = JSON.parse(localStorage.getItem(DOCK_KEY) || \"null\"); } catch {}\n    if (pos && Number.isFinite(pos.left) && Number.isFinite(pos.top)) {\n      dock.classList.add(\"am-player--free\");\n      dock.style.transform = \"none\";\n      dock.style.left = `${pos.left}px`;\n      dock.style.top  = `${pos.top}px`;\n      dock.style.right = \"auto\";\n      dock.style.bottom = \"auto\";\n      clampDock();\n    } else {\n      dock.classList.remove(\"am-player--free\");\n      dock.style.left = \"\";\n      dock.style.top  = \"\";\n      dock.style.right = \"\";\n      dock.style.bottom = \"\";\n      dock.style.transform = \"\";\n    }\n  }\n  function beginDockDrag(e) {\n    if (!dock.classList.contains(\"am-player--free\")) {\n      const r = dock.getBoundingClientRect();\n      dock.classList.add(\"am-player--free\");\n      dock.style.transform = \"none\";\n      dock.style.left = `${r.left}px`;\n      dock.style.top  = `${r.top}px`;\n      dock.style.right = \"auto\";\n      dock.style.bottom = \"auto\";\n    }\n    dockDrag = {\n      startX: e.clientX,\n      startY: e.clientY,\n      baseLeft: parseFloat(dock.style.left || \"0\"),\n      baseTop:  parseFloat(dock.style.top || \"0\"),\n    };\n    dragzone.classList.add(\"dragging\");\n    try { dragzone.setPointerCapture?.(e.pointerId); } catch {}\n  }\n  function moveDockDrag(e) {\n    if (!dockDrag) return;\n    let left = dockDrag.baseLeft + (e.clientX - dockDrag.startX);\n    let top  = dockDrag.baseTop  + (e.clientY - dockDrag.startY);\n    const r = dock.getBoundingClientRect();\n    const { w, h } = getVP();\n    left = clamp(left, 8, Math.max(8, w - r.width - 8));\n    top  = clamp(top,  8, Math.max(8, h - r.height - 8));\n    dock.style.left = `${left}px`;\n    dock.style.top  = `${top}px`;\n  }\n  function endDockDrag(e) {\n    if (!dockDrag) return;\n    try { dragzone.releasePointerCapture?.(e.pointerId); } catch {}\n    dragzone.classList.remove(\"dragging\");\n    dockDrag = null;\n    clampDock();\n  }\n\n  dragzone.addEventListener(\"pointerdown\", beginDockDrag);\n  window.addEventListener(\"pointermove\", moveDockDrag);\n  window.addEventListener(\"pointerup\", endDockDrag);\n  window.addEventListener(\"resize\", clampDock);\n  window.visualViewport?.addEventListener(\"resize\", clampDock);\n  window.addEventListener(\"orientationchange\", clampDock);\n\n  /* ---------- ПУЗЫРЬ ---------- */\n  function ensureBubble() {\n    if (bubble) return bubble;\n    bubble = document.createElement(\"button\");\n    bubble.className = \"am-player__bubble is-paused\";\n    bubble.type = \"button\";\n    bubble.setAttribute(\"aria-label\", \"Open player\");\n    bubble.style.display = \"none\";\n    bubble.style.left = \"auto\";\n    bubble.style.top = \"auto\";\n    bubble.style.right = \"auto\";\n    bubble.style.bottom = \"auto\";\n    bubble.innerHTML = `<span class=\"note\">♪</span>`;\n    document.body.appendChild(bubble);\n\n    bubble.addEventListener(\"pointerdown\", (e) => {\n      bubbleDragging = false;\n      try { bubble.setPointerCapture(e.pointerId); } catch {}\n      const r = bubble.getBoundingClientRect();\n      bubbleStart = { x: e.clientX, y: e.clientY, left: r.left, top: r.top };\n    });\n    bubble.addEventListener(\"pointermove\", (e) => {\n      if (!bubbleStart) return;\n      const dx = e.clientX - bubbleStart.x;\n      const dy = e.clientY - bubbleStart.y;\n      if (Math.abs(dx) + Math.abs(dy) > 3) bubbleDragging = true;\n      const nx = (bubbleStart.left + dx) | 0;\n      const ny = (bubbleStart.top  + dy) | 0;\n      bubble.style.right = \"auto\";\n      bubble.style.bottom = \"auto\";\n      bubble.style.left = `${nx}px`;\n      bubble.style.top  = `${ny}px`;\n    });\n    bubble.addEventListener(\"pointerup\", (e) => {\n      try { bubble.releasePointerCapture(e.pointerId); } catch {}\n      if (!bubbleDragging) { uiMin(false); } // клик — раскрыть\n      clampBubbleToViewport();\n      persistBubblePos();\n      bubbleStart = null;\n      bubbleDragging = false;\n    });\n\n    return bubble;\n  }\n\n  function getStableWH() {\n    const w = document.documentElement.clientWidth || window.innerWidth;\n    const h = document.documentElement.clientHeight || window.innerHeight;\n    return { w, h };\n  }\n  function saveBubblePos(left, top, width, height) {\n    const { w, h } = getStableWH();\n    const rw = Math.max(1, w - width);\n    const rh = Math.max(1, h - height);\n    _bubblePos = {\n      left, top, width, height,\n      rx: clamp(left / rw, 0, 1),\n      ry: clamp(top  / rh, 0, 1)\n    };\n    try { localStorage.setItem(BUBBLE_KEY, JSON.stringify(_bubblePos)); } catch {}\n  }\n  function loadBubblePos() {\n    if (_bubblePos && Number.isFinite(_bubblePos.left) && Number.isFinite(_bubblePos.top)) return _bubblePos;\n    try {\n      const obj = JSON.parse(localStorage.getItem(BUBBLE_KEY) || \"null\");\n      if (obj && Number.isFinite(obj.rx) && Number.isFinite(obj.ry)) return obj;\n    } catch {}\n    return null;\n  }\n  function fromRatioToPx(pos, fallback = 64) {\n    const { w, h } = getStableWH();\n    const bw = pos?.width  || fallback;\n    const bh = pos?.height || fallback;\n    const rw = Math.max(1, w - bw);\n    const rh = Math.max(1, h - bh);\n    const left = clamp(Math.round((pos?.rx ?? 0.5) * rw), 8, rw);\n    const top  = clamp(Math.round((pos?.ry ?? 0.8) * rh), 8, rh);\n    return { left, top };\n  }\n  function showBubble(useSaved = true) {\n    const b = ensureBubble();\n    b.style.right = \"auto\";\n    b.style.bottom = \"auto\";\n    b.style.display = \"grid\";\n\n    const r0 = b.getBoundingClientRect();\n    let pos = useSaved ? loadBubblePos() : null;\n    let left, top;\n    if (pos) {\n      const p = fromRatioToPx(pos, r0.width || 64);\n      left = p.left; top = p.top;\n    } else {\n      const { w, h } = getVP();\n      const size = r0.width || 64;\n      left = Math.max(8, Math.round((w - size) / 2));\n      top  = Math.max(8, Math.round(h - size - 24));\n    }\n    b.style.left = `${left}px`;\n    b.style.top  = `${top}px`;\n    clampBubbleToViewport();\n    persistBubblePos();\n  }\n  function hideBubble() { if (bubble) bubble.style.display = \"none\"; }\n  function setBubblePulse(isPlaying) {\n    const b = ensureBubble();\n    b.classList.toggle(\"is-paused\", !isPlaying);\n  }\n  function setBubbleAmp(v) {\n    const b = ensureBubble();\n    const amp = 1.02 + (Math.max(0, Math.min(100, v)) / 100) * 0.08;\n    b.style.setProperty(\"--amp\", amp.toFixed(3));\n  }\n  function clampBubbleToViewport(margin = 8) {\n    if (!bubble || bubble.style.display === \"none\") return;\n    const { w, h } = getVP();\n    const r = bubble.getBoundingClientRect();\n    let left = clamp(r.left, margin, Math.max(margin, w - r.width - margin));\n    let top  = clamp(r.top,  margin, Math.max(margin, h - r.height - margin));\n    bubble.style.right = \"auto\";\n    bubble.style.bottom = \"auto\";\n    bubble.style.left = `${left}px`;\n    bubble.style.top  = `${top}px`;\n  }\n  function persistBubblePos() {\n    if (!bubble || bubble.style.display === \"none\") return;\n    const r = bubble.getBoundingClientRect();\n    saveBubblePos(r.left, r.top, r.width, r.height);\n  }\n  window.addEventListener(\"resize\", () => { clampBubbleToViewport(); persistBubblePos(); });\n  window.visualViewport?.addEventListener(\"resize\", () => { clampBubbleToViewport(); persistBubblePos(); });\n  window.addEventListener(\"orientationchange\", () => { clampBubbleToViewport(); persistBubblePos(); });\n\n  /* ---------- Кнопки UI ---------- */\n  btnClose.addEventListener(\"click\", () => {\n    try { yt?.stopVideo?.(); yt?.destroy?.(); } catch {}\n    yt = null; ready = false; duration = 0; clearTimer(); clearWatchdog();\n    uiShow(false);\n    uiMin(false);\n    queue = []; qi = -1;\n    setBubblePulse(false);\n  });\n\n  btnHide.addEventListener(\"click\", () => { uiMin(true); });\n\n  // Ссылка YouTube ↗: перед навигацией — выключаем плеер\n  aYTlink.addEventListener(\"click\", () => {\n    try { yt?.stopVideo?.(); yt?.destroy?.(); } catch {}\n    yt = null; ready = false; duration = 0; clearTimer(); clearWatchdog();\n    uiShow(false);\n    uiMin(false);\n    queue = []; qi = -1;\n    setBubblePulse(false);\n    // дальше браузер откроет ссылку в новой вкладке\n  });\n\n  btnPlay.addEventListener(\"click\", () => {\n    if (!ready || !yt) return;\n    const s = yt.getPlayerState ? yt.getPlayerState() : -1;\n    if (s === YT.PlayerState.PLAYING) {\n      yt.pauseVideo?.(); uiPlayIcon(false); setBubblePulse(false);\n    } else {\n      yt.playVideo?.();  uiPlayIcon(true);  setBubblePulse(true);\n    }\n  });\n  btnPrev.addEventListener(\"click\", () => {\n    if (!queue.length) return;\n    playByIndex(qi > 0 ? qi - 1 : (loop ? queue.length - 1 : 0));\n  });\n  btnNext.addEventListener(\"click\", () => {\n    if (!queue.length) return;\n    playByIndex(qi < queue.length - 1 ? qi + 1 : (loop ? 0 : qi));\n  });\n  btnMute.addEventListener(\"click\", () => {\n    if (!yt) return;\n    muted = !muted;\n    if (muted) yt.mute?.(); else yt.unMute?.();\n    uiMuteIcon(muted);\n  });\n  vol.addEventListener(\"input\", () => {\n    const v = Number(vol.value) || 0;\n    volVal = v;\n    if (!isIOS) yt?.setVolume?.(v);\n    if (v === 0 && !muted) { muted = true; yt?.mute?.(); uiMuteIcon(true); }\n    else if (v > 0 && muted) { muted = false; yt?.unMute?.(); uiMuteIcon(false); }\n    setBubbleAmp(v);\n  });\n  prog.addEventListener(\"input\", () => {\n    userSeeking = true;\n    const v = Number(prog.value) || 0;\n    const sec = duration > 0 ? (v / 1000) * duration : 0;\n    tCur.textContent = fmtTimeSec(sec);\n  });\n  prog.addEventListener(\"change\", () => {\n    userSeeking = false;\n    if (!yt || !duration) return;\n    const v = Number(prog.value) || 0;\n    const sec = (v / 1000) * duration;\n    yt.seekTo?.(sec, true);\n  });\n\n  /* ---------- Публичное API ---------- */\n  async function open(urlOrId) {\n    const id = getYouTubeId(urlOrId);\n    if (!id) return;\n    queue = [id]; qi = 0;\n    uiMin(false); uiShow(true);\n    restoreDockPos();\n    await playByIndex(0);\n  }\n  async function openQueue(list, opts = {}) {\n    const ids = (list || []).map(getYouTubeId).filter(Boolean);\n    if (!ids.length) return;\n    loop = !!opts.loop;\n    const arr = opts.shuffle ? shuffleArr(ids) : ids.slice();\n    queue = arr;\n    const start = clamp(Number(opts.startIndex ?? 0) || 0, 0, queue.length - 1);\n    uiMin(false); uiShow(true);\n    restoreDockPos();\n    await playByIndex(start);\n  }\n  function next() { if (queue.length) playByIndex(qi < queue.length - 1 ? qi + 1 : (loop ? 0 : qi)); }\n  function prev() { if (queue.length) playByIndex(qi > 0 ? qi - 1 : (loop ? queue.length - 1 : 0)); }\n  function isActive() { return dock.classList.contains(\"am-player--active\") && !dock.classList.contains(\"am-player--min\"); }\n  function minimize() { uiMin(true); }\n  function close() { btnClose.click(); }\n\n  _instance = { open, openQueue, next, prev, minimize, isActive, close };\n  return _instance;\n}\n","\n// Оверлей зума: без искажений на моб/таб + pinch/zoom/pan + колесо/двойной клик\n\nlet overlay, dialogEl, stageEl, imgEl, linkEl, closeBtn, backdropEl;\nlet isPanning = false, startX = 0, startY = 0, curX = 0, curY = 0, scale = 1;\nlet baseW = 0, baseH = 0, stageW = 0, stageH = 0;\nconst activePointers = new Map();\nlet pinchActive = false, pinchBaseDist = 0, pinchBaseScale = 1;\n\nconst clamp = (v, min, max) => Math.max(min, Math.min(max, v));\nconst dist = (a, b) => Math.hypot(a.x - b.x, a.y - b.y);\nconst midpoint = (a, b) => ({ x: (a.x + b.x) / 2, y: (a.y + b.y) / 2 });\n\n/* ---------- ensure ---------- */\nfunction ensureZoom() {\n  if (overlay) return;\n\n  overlay = document.createElement(\"div\");\n  overlay.className = \"am-zoom\";\n  overlay.innerHTML = `\n    <div class=\"am-zoom__backdrop\"></div>\n    <div class=\"am-zoom__dialog\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Image preview\">\n      <div class=\"am-zoom__stage\">\n        <img class=\"am-zoom__img\" alt=\"\">\n      </div>\n      <div class=\"am-zoom__bar\">\n        <a class=\"am-zoom__open\" href=\"#\" target=\"_blank\" rel=\"noopener noreferrer\">Open original ↗</a>\n        <button class=\"am-zoom__close\" type=\"button\" aria-label=\"Close\">×</button>\n      </div>\n    </div>`;\n  document.body.appendChild(overlay);\n\n  // базовые стилевые фолбэки (если вдруг профильный CSS не подключен)\n  Object.assign(overlay.style, { position: \"fixed\", inset: \"0\", zIndex: \"6000\", display: \"none\" });\n  dialogEl = overlay.querySelector(\".am-zoom__dialog\");\n  Object.assign(dialogEl.style, {\n    position: \"absolute\", inset: \"0\", display: \"grid\",\n    gridTemplateRows: \"1fr auto\", gap: \"12px\", padding: \"16px\"\n  });\n\n  backdropEl = overlay.querySelector(\".am-zoom__backdrop\");\n  Object.assign(backdropEl.style, { position: \"absolute\", inset: \"0\", background: \"rgba(0,0,0,.7)\" });\n\n  stageEl = overlay.querySelector(\".am-zoom__stage\");\n  Object.assign(stageEl.style, {\n    position: \"relative\",\n    background: \"#000\",\n    borderRadius: \"12px\",\n    overflow: \"hidden\",\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    minHeight: \"240px\",\n    height: \"calc(100vh - 140px)\",\n    touchAction: \"none\" // жесты — нашими руками\n  });\n\n  imgEl = overlay.querySelector(\".am-zoom__img\");\n  // важные анти-искажения + перехват global img{height:100%}\n  imgEl.style.maxWidth = \"100%\";\n  imgEl.style.maxHeight = \"100%\";\n  imgEl.style.width = \"auto\";\n  imgEl.style.setProperty(\"height\", \"auto\", \"important\");\n  imgEl.style.objectFit = \"contain\";\n  imgEl.style.transformOrigin = \"center center\";\n  imgEl.style.willChange = \"transform\";\n  imgEl.style.userSelect = \"none\";\n  imgEl.style.webkitUserDrag = \"none\";\n  imgEl.style.pointerEvents = \"auto\";\n\n  const bar = overlay.querySelector(\".am-zoom__bar\");\n  Object.assign(bar.style, {\n    display: \"flex\", justifyContent: \"space-between\",\n    alignItems: \"center\", gap: \"12px\"\n  });\n\n  linkEl = overlay.querySelector(\".am-zoom__open\");\n  linkEl.style.color = \"#fff\";\n  closeBtn = overlay.querySelector(\".am-zoom__close\");\n  Object.assign(closeBtn.style, {\n    width: \"40px\", height: \"40px\", borderRadius: \"10px\",\n    border: \"none\", background: \"var(--color-affair, #764191)\", color: \"#fff\", cursor: \"pointer\"\n  });\n\n  // события\n  backdropEl.addEventListener(\"click\", closeZoom);\n  closeBtn.addEventListener(\"click\", closeZoom);\n\n  overlay.addEventListener(\"wheel\", onWheel, { passive: false });\n  imgEl.addEventListener(\"dblclick\", toggleZoom);\n\n  imgEl.addEventListener(\"pointerdown\", onPointerDown);\n  imgEl.addEventListener(\"pointermove\", onPointerMove);\n  imgEl.addEventListener(\"pointerup\", onPointerUpCancel);\n  imgEl.addEventListener(\"pointercancel\", onPointerUpCancel);\n\n  document.addEventListener(\"keydown\", (e) => { if (e.key === \"Escape\" && isZoomOpen()) closeZoom(); });\n  window.addEventListener(\"resize\", () => { if (isZoomOpen()) { measureStage(); applyTransform(); } });\n}\n\n/* ---------- measurements ---------- */\nfunction measureBase() {\n  const prev = imgEl.style.transform;\n  imgEl.style.transform = \"translate3d(0,0,0) scale(1)\";\n  const r = imgEl.getBoundingClientRect();\n  imgEl.style.transform = prev;\n  baseW = r.width; baseH = r.height;\n}\nfunction measureStage() {\n  const s = stageEl.getBoundingClientRect();\n  stageW = s.width; stageH = s.height;\n}\nfunction clampPan() {\n  if (!baseW || !baseH || !stageW || !stageH) return;\n  const contentW = baseW * scale, contentH = baseH * scale;\n  if (contentW <= stageW) curX = 0;\n  else { const maxX = (contentW - stageW) / 2; curX = clamp(curX, -maxX, maxX); }\n  if (contentH <= stageH) curY = 0;\n  else { const maxY = (contentH - stageH) / 2; curY = clamp(curY, -maxY, maxY); }\n}\nfunction applyTransform() {\n  clampPan();\n  imgEl.style.transform = `translate3d(${curX}px, ${curY}px, 0) scale(${scale})`;\n  imgEl.style.cursor = scale > 1 ? (isPanning ? \"grabbing\" : \"grab\") : \"zoom-in\";\n}\n\n/* ---------- API ---------- */\nexport function openZoom(src, alt = \"\") {\n  if (!src) return;\n  ensureZoom();\n\n  // сброс состояния\n  activePointers.clear();\n  pinchActive = false; pinchBaseDist = 0; pinchBaseScale = 1;\n  isPanning = false; startX = startY = 0; curX = curY = 0; scale = 1;\n\n  imgEl.src = src;\n  imgEl.alt = alt || \"\";\n  linkEl.href = src;\n\n  overlay.style.display = \"block\";\n\n  const doMeasure = () => { measureStage(); measureBase(); clampPan(); applyTransform(); };\n  if (imgEl.complete && imgEl.naturalWidth > 0) requestAnimationFrame(doMeasure);\n  else imgEl.onload = () => requestAnimationFrame(doMeasure);\n}\n\nexport function closeZoom() {\n  if (!overlay) return;\n  overlay.style.display = \"none\";\n  imgEl.src = \"\";\n  activePointers.clear();\n  pinchActive = false;\n}\n\nexport function isZoomOpen() {\n  return !!(overlay && overlay.style.display !== \"none\");\n}\n\n/* ---------- gestures ---------- */\nfunction toggleZoom() {\n  const prev = scale;\n  scale = prev > 1 ? 1 : 2;\n  if (scale === 1) { curX = 0; curY = 0; }\n  applyTransform();\n}\nfunction onWheel(e) {\n  if (!isZoomOpen()) return;\n  e.preventDefault();\n  const newScale = clamp(scale + (e.deltaY > 0 ? -0.15 : 0.15), 1, 3);\n\n  const rect = imgEl.getBoundingClientRect();\n  const pivot = { x: e.clientX, y: e.clientY };\n  const center = { x: rect.left + rect.width / 2, y: rect.top + rect.height / 2 };\n  const factor = newScale / scale;\n  curX += (center.x - pivot.x) * (1 - factor);\n  curY += (center.y - pivot.y) * (1 - factor);\n\n  scale = newScale;\n  if (scale === 1) { curX = 0; curY = 0; }\n  applyTransform();\n}\nfunction onPointerDown(e) {\n  activePointers.set(e.pointerId, { x: e.clientX, y: e.clientY });\n  imgEl.setPointerCapture(e.pointerId);\n\n  if (activePointers.size === 2) {\n    const [p1, p2] = Array.from(activePointers.values());\n    pinchActive = true;\n    pinchBaseDist = dist(p1, p2) || 1;\n    pinchBaseScale = scale;\n    isPanning = false;\n    return;\n  }\n  if (activePointers.size === 1 && scale > 1) {\n    isPanning = true;\n    startX = e.clientX - curX;\n    startY = e.clientY - curY;\n    applyTransform();\n  }\n}\nfunction onPointerMove(e) {\n  if (!activePointers.has(e.pointerId)) return;\n  activePointers.set(e.pointerId, { x: e.clientX, y: e.clientY });\n\n  if (pinchActive && activePointers.size >= 2) {\n    const [p1, p2] = Array.from(activePointers.values());\n    const d = dist(p1, p2) || 1;\n    let newScale = clamp(pinchBaseScale * (d / pinchBaseDist), 1, 3);\n\n    const mid = midpoint(p1, p2);\n    const rect = imgEl.getBoundingClientRect();\n    const center = { x: rect.left + rect.width / 2, y: rect.top + rect.height / 2 };\n    const factor = newScale / scale;\n    curX += (center.x - mid.x) * (1 - factor);\n    curY += (center.y - mid.y) * (1 - factor);\n\n    scale = newScale;\n    if (scale === 1) { curX = 0; curY = 0; }\n    applyTransform();\n    return;\n  }\n\n  if (isPanning && activePointers.size === 1 && scale > 1) {\n    curX = e.clientX - startX;\n    curY = e.clientY - startY;\n    applyTransform();\n  }\n}\nfunction onPointerUpCancel(e) {\n  if (activePointers.has(e.pointerId)) activePointers.delete(e.pointerId);\n  try { imgEl.releasePointerCapture(e.pointerId); } catch {}\n  if (activePointers.size < 2) { pinchActive = false; pinchBaseDist = 0; }\n  if (activePointers.size === 0) { isPanning = false; applyTransform(); }\n}\n","// src/js/artists/features/modal.js\nimport { lockScroll, unlockScroll } from \"../lib/scroll-lock.js\";\nimport { UISound } from \"../lib/sound.js\";\nimport { fetchArtist, fetchArtistAlbums } from \"./api.js\";\nimport { createMiniPlayer } from \"./player.js\";\nimport { openZoom } from \"./zoom.js\";\n\n/* ---------- SPRITE: robust base path + helper ---------- */\nfunction detectBasePath() {\n  // 1) <base href=\"...\">\n  try {\n    const baseEl = document.querySelector(\"base\");\n    if (baseEl?.href) {\n      const u = new URL(baseEl.getAttribute(\"href\"), location.href);\n      return u.pathname.replace(/\\/$/, \"\");\n    }\n  } catch {}\n\n  // 2) Vite BASE_URL (заменяется на сборке)\n  const viteBase =\n    (typeof import.meta !== \"undefined\" &&\n      import.meta.env &&\n      typeof import.meta.env.BASE_URL === \"string\")\n      ? import.meta.env.BASE_URL\n      : \"\";\n  if (viteBase) return viteBase.replace(/\\/$/, \"\");\n\n  // 3) GitHub Pages: username.github.io/<repo>/...\n  if (location.hostname.endsWith(\"github.io\")) {\n    const parts = location.pathname.split(\"/\").filter(Boolean);\n    return parts.length ? `/${parts[0]}` : \"\";\n  }\n\n  // 4) по умолчанию — корень\n  return \"\";\n}\nconst BASE_URL = detectBasePath();\nconst SPRITE   = `${BASE_URL}/img/sprite.svg`;\n\nconst icon = (id, cls = \"ico\") =>\n  `<svg class=\"${cls}\" aria-hidden=\"true\"><use href=\"${SPRITE}#${id}\" xlink:href=\"${SPRITE}#${id}\"></use></svg>`;\n\n/* ----------------- helpers ----------------- */\nfunction fmtTime(msLike) {\n  const ms = Number(msLike);\n  if (!Number.isFinite(ms)) return \"—\";\n  const total = Math.round(ms / 1000);\n  const m = Math.floor(total / 60);\n  const s = String(total % 60).padStart(2, \"0\");\n  return `${m}:${s}`;\n}\nfunction years(d = {}) {\n  const s = d.intFormedYear || d.yearStart || d.formedYear;\n  const e = d.intDisbandedYear || d.intDiedYear || d.yearEnd || d.disbandedYear;\n  if (s && e) return `${s}–${e}`;\n  if (s) return `${s}–present`;\n  return \"information missing\";\n}\nfunction trackRow(t = {}) {\n  const title = t.strTrack || t.title || t.name || \"—\";\n  const dur   = fmtTime(t.intDuration ?? t.duration ?? t.time);\n  const link  = t.movie ?? t.youtube ?? t.youtube_url ?? t.url ?? t.strMusicVid;\n  return `\n    <li class=\"tr\">\n      <span>${title}</span>\n      <span>${dur}</span>\n      <span>${\n        link\n          ? `<a class=\"yt\" href=\"${link}\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label=\"Play\">\n               ${icon(\"icon-icon_youtube_footer\", \"ico am-yt\")}\n             </a>`\n          : `<span class=\"yt-ph\"></span>`\n      }</span>\n    </li>`;\n}\n\n/* ---------- ensure shell (если partial не вставлен) ---------- */\nfunction ensureModalShell(doc = document) {\n  let modal = doc.querySelector(\"#artist-modal\");\n  if (modal) return modal;\n\n  modal = doc.createElement(\"div\");\n  modal.id = \"artist-modal\";\n  modal.className = \"amodal\";\n  modal.setAttribute(\"hidden\", \"\");\n  modal.innerHTML = `\n    <div class=\"amodal__backdrop\"></div>\n    <div class=\"amodal__dialog\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Artist details\">\n      <button id=\"am-close\" class=\"amodal__close\" type=\"button\" aria-label=\"Close\">×</button>\n      <div id=\"am-body\" class=\"amodal__body\">\n        <div class=\"amodal__loader loader\"></div>\n      </div>\n    </div>`;\n  doc.body.appendChild(modal);\n  return modal;\n}\n\n/* ----------------- main ----------------- */\nexport function createArtistModal(rootEl = document) {\n  const modal =\n    (rootEl && rootEl.querySelector ? rootEl.querySelector(\"#artist-modal\") : null) ||\n    document.querySelector(\"#artist-modal\") ||\n    ensureModalShell(document);\n\n  const modalBody  = modal.querySelector(\"#am-body\");\n  const modalClose = modal.querySelector(\"#am-close\");\n  const dialog     = modal.querySelector(\".amodal__dialog\");\n\n  // Единый мини-плеер\n  const player = createMiniPlayer();\n\n  // -------- Scroll-to-top --------\n  let scrollTopBtn = null;\n\n  // делаем обработчики съемными и безопасными\n  let placeScrollTopHandler = () => {}; // no-op по умолчанию\n  let onDialogScroll = null;\n  let onWinResize    = null;\n\n  function ensureScrollTop() {\n    if (scrollTopBtn) return;\n\n    scrollTopBtn = document.createElement(\"button\");\n    scrollTopBtn.type = \"button\";\n    scrollTopBtn.className = \"amodal__scrolltop\";\n    scrollTopBtn.setAttribute(\"aria-label\", \"Scroll to top\");\n    scrollTopBtn.textContent = \"↑\";\n    dialog.appendChild(scrollTopBtn);\n\n    scrollTopBtn.addEventListener(\"click\", () => {\n      UISound?.tap?.();\n      dialog.scrollTo({ top: 0, behavior: \"smooth\" });\n    });\n\n    // вычисление позиции кнопки относительно правого края диалога\n    placeScrollTopHandler = () => {\n      try {\n        const pad = 24; // отступ внутрь от контейнера\n        const r = dialog.getBoundingClientRect();\n        const right = Math.max(pad, window.innerWidth - (r.left + r.width) + pad);\n        scrollTopBtn.style.right  = `${right}px`;\n        scrollTopBtn.style.bottom = `58px`; // поднята выше на ~30px\n      } catch {}\n    };\n\n    // видимость по скроллу + актуализация позиции\n    onDialogScroll = () => {\n      try {\n        scrollTopBtn.style.display = (dialog.scrollTop || 0) > 220 ? \"flex\" : \"none\";\n        placeScrollTopHandler();\n      } catch {}\n    };\n    dialog.addEventListener(\"scroll\", onDialogScroll);\n\n    // ресайз/ориентация\n    onWinResize = () => { placeScrollTopHandler(); };\n    window.addEventListener(\"resize\", onWinResize);\n    window.visualViewport?.addEventListener(\"resize\", onWinResize);\n    window.addEventListener(\"orientationchange\", onWinResize);\n\n    // первичное размещение\n    placeScrollTopHandler();\n  }\n\n  // -------- open/close --------\n  const onEsc = (e) => {\n    if (e.key === \"Escape\") {\n      UISound?.tap?.();\n      close();\n    }\n  };\n\n  function open() {\n    modal.removeAttribute(\"hidden\");\n    lockScroll();\n    ensureScrollTop();\n    if (scrollTopBtn) scrollTopBtn.style.display = \"none\"; // скрыта до первой прокрутки\n    modalBody.innerHTML = `<div class=\"amodal__loader loader\"></div>`;\n    document.addEventListener(\"keydown\", onEsc);\n  }\n\n  function close() {\n    modal.setAttribute(\"hidden\", \"\");\n    unlockScroll();\n    modalBody.innerHTML = \"\";\n    document.removeEventListener(\"keydown\", onEsc);\n\n    // аккуратно снимаем слушатели и не оставляем висячих ссылок\n    if (onDialogScroll) {\n      dialog.removeEventListener(\"scroll\", onDialogScroll);\n      onDialogScroll = null;\n    }\n    if (onWinResize) {\n      window.removeEventListener(\"resize\", onWinResize);\n      window.visualViewport?.removeEventListener(\"resize\", onWinResize);\n      window.removeEventListener(\"orientationchange\", onWinResize);\n      onWinResize = null;\n    }\n    // делаем обработчик безопасным no-op (на случай гонок)\n    placeScrollTopHandler = () => {};\n\n    if (scrollTopBtn) scrollTopBtn.style.display = \"none\";\n  }\n\n  modalClose.addEventListener(\"click\", () => { UISound?.tap?.(); close(); });\n  modal.addEventListener(\"click\", (e) => {\n    if (e.target.classList.contains(\"amodal__backdrop\")) {\n      UISound?.tap?.(); close();\n    }\n  });\n\n  // Делегирование кликов: YouTube => открыть наш плеер, Zoom — по картинке\n  modal.addEventListener(\"click\", (e) => {\n    const a = e.target.closest(\"a.yt\");\n    if (a) {\n      e.preventDefault();\n      UISound?.tap?.();\n      player.open(a.href);  // играем внутри сайта\n      return;\n    }\n    const zoomImg = e.target.closest(\".amodal__img\");\n    if (zoomImg) {\n      UISound?.tap?.();\n      const src =\n        zoomImg.currentSrc ||\n        zoomImg.getAttribute(\"src\") ||\n        zoomImg.getAttribute(\"data-src\") ||\n        \"\";\n      openZoom(src, zoomImg.getAttribute(\"alt\") || \"\");\n    }\n  });\n\n  // -------- render --------\n  async function render(artistId) {\n    const [artist, albums] = await Promise.all([\n      fetchArtist(artistId).catch(() => ({})),\n      fetchArtistAlbums(artistId).catch(() => []),\n    ]);\n\n    const d = artist || {};\n    const name    = d.strArtist || d.name || \"Unknown artist\";\n    const img     = d.strArtistThumb || d.photo || d.image || \"https://via.placeholder.com/960x540?text=No+Image\";\n    const country = d.strCountry || d.country || \"N/A\";\n    const members = d.intMembers || d.members || \"N/A\";\n    const sex     = d.strGender || d.sex || \"N/A\";\n    const bio     = d.strBiographyEN || d.about || \"\";\n    const genres  = Array.isArray(d.genres) ? d.genres : (d.genre ? [d.genre] : []);\n\n    const albumsArr = Array.isArray(albums) ? albums : [];\n    const albumsMarkup = albumsArr.map(alb => {\n      const title  = alb?.strAlbum || alb?.title || alb?.name || \"Album\";\n      const tracks = Array.isArray(alb?.tracks) ? alb.tracks :\n                     (Array.isArray(alb?.songs) ? alb.songs : []);\n      return `\n        <div class=\"am-album\">\n          <div class=\"am-album__title\">${title}</div>\n          <ul class=\"tbl\">\n            <li class=\"th\"><span>Track</span><span>Time</span><span>Link</span></li>\n            ${tracks.map(trackRow).join(\"\")}\n          </ul>\n        </div>`;\n    }).join(\"\");\n\n    modalBody.innerHTML = `\n      <h3 class=\"amodal__title\">${name}</h3>\n\n      <div class=\"amodal__content\">\n        <img class=\"amodal__img\" src=\"${img}\" alt=\"${name}\" loading=\"lazy\">\n        <div class=\"amodal__info\">\n          <div class=\"am-meta\">\n            <div class=\"am-meta__col\">\n              <div class=\"am-meta__item\"><span class=\"lbl\">Years active</span><span class=\"val\">${years(d)}</span></div>\n              <div class=\"am-meta__item\"><span class=\"lbl\">Sex</span><span class=\"val\">${sex}</span></div>\n            </div>\n            <div class=\"am-meta__col\">\n              <div class=\"am-meta__item\"><span class=\"lbl\">Members</span><span class=\"val\">${members}</span></div>\n              <div class=\"am-meta__item\"><span class=\"lbl\">Country</span><span class=\"val\">${country}</span></div>\n            </div>\n          </div>\n\n          <div class=\"am-bio\">\n            <div class=\"lbl\">Biography</div>\n            <p>${bio || \"—\"}</p>\n          </div>\n\n          ${genres.length ? `<div class=\"am-tags\">${genres.map(g => `<span class=\"tag\">${g}</span>`).join(\"\")}</div>` : \"\"}\n        </div>\n      </div>\n\n      <h4 class=\"amodal__albums-title\">Albums</h4>\n      <div class=\"amodal__albums\">\n        ${albumsMarkup || \"<p class='muted'>No albums found for this artist.</p>\"}\n      </div>`;\n  }\n\n  // -------- public API --------\n  async function openFor(id) {\n    UISound?.tap?.();\n    open();\n    await render(id);\n  }\n\n  return { openFor, close };\n}\n","export default \"__VITE_ASSET__D3LZ2Ejb__\"","\nimport spriteUrl from '../../img/sprite.svg?url';\n\nexport const SPRITE = spriteUrl;\n\nexport const icon = (id, cls = 'ico') =>\n  `<svg class=\"${cls}\" aria-hidden=\"true\"><use href=\"${SPRITE}#${id}\"></use></svg>`;\n","// src/js/artists/features/grid.js\nimport { UISound } from \"../lib/sound.js\";\nimport { fetchArtists, fetchGenres } from \"./api.js\";\nimport { ArtistState } from \"./state.js\";\nimport { createArtistModal } from \"./modal.js\";\nimport { openZoom } from \"./zoom.js\";\nimport { icon } from \"../../shared/sprite.js\"; // <-- оставляем только helper\n\n/* ---------- view-mode persistence ---------- */\nconst VIEW_KEY = \"artistsViewMode\"; // \"grid\" | \"list\"\nconst DEFAULT_LIMIT = 8;\nconst LIST_LIMIT = 14;\nconst getSavedView = () =>\n  (localStorage.getItem(VIEW_KEY) === \"list\" ? \"list\" : \"grid\");\nconst saveView = (mode) => {\n  try {\n    localStorage.setItem(VIEW_KEY, mode);\n  } catch {}\n};\n\n/* ---------- main ---------- */\nexport function initGrid(root = document.querySelector(\"#artists-section\")) {\n  if (!root) return;\n\n  // ---------- refs ----------\n  const panel = root.querySelector(\"#filters-panel\");\n  const toggleBtn = root.querySelector(\"#filters-toggle\");\n  const resetBtn = root.querySelector(\"#filters-reset\");\n  const resetBtnSm = root.querySelector(\"#filters-reset-sm\");\n  let viewToggle = root.querySelector(\"#view-toggle\"); // может отсутствовать\n\n  const searchInput = root.querySelector(\"#flt-q\");\n  const searchBtn = root.querySelector(\"#flt-q-btn\");\n\n  const ddSort = root.querySelector('.dd[data-dd=\"sort\"]');\n  const ddSortBtn = root.querySelector(\"#dd-sort-btn\");\n  const ddSortList = root.querySelector(\"#dd-sort-list\");\n\n  const ddGenre = root.querySelector('.dd[data-dd=\"genre\"]');\n  const ddGenreBtn = root.querySelector(\"#dd-genre-btn\");\n  const ddGenreList = root.querySelector(\"#dd-genre-list\");\n\n  const grid = root.querySelector(\"#artists-grid\");\n  const pager = root.querySelector(\"#artists-pager\");\n  const empty = root.querySelector(\"#artists-empty\");\n\n  // модалка\n  const modalApi = createArtistModal(document);\n\n  // защита от гонок API\n  let reqId = 0;\n\n  // ---------- utils ----------\n  const show = (el) => el && el.removeAttribute(\"hidden\");\n  const hide = (el) => el && el.setAttribute(\"hidden\", \"\");\n  const isDesktop = () => matchMedia(\"(min-width:1440px)\").matches;\n  const byName = (a) => (a?.strArtist || a?.name || \"\").toLowerCase();\n\n  function syncPanelMode() {\n    const st = ArtistState.get();\n    if (isDesktop()) {\n      panel?.setAttribute(\"aria-hidden\", \"false\");\n      toggleBtn?.setAttribute(\"aria-expanded\", \"false\");\n      ArtistState.setMobilePanel(false);\n    } else {\n      panel?.setAttribute(\n        \"aria-hidden\",\n        st.isMobilePanelOpen ? \"false\" : \"true\"\n      );\n      toggleBtn?.setAttribute(\n        \"aria-expanded\",\n        st.isMobilePanelOpen ? \"true\" : \"false\"\n      );\n    }\n  }\n\n  function scrollToGridTop() {\n    const top = root.getBoundingClientRect().top + window.scrollY - 16;\n    window.scrollTo({ top, behavior: \"smooth\" });\n  }\n\n  function applyEmpty(on) {\n    if (on) {\n      show(empty);\n      hide(grid);\n      hide(pager);\n      resetGridInlineStyles();\n    } else {\n      hide(empty);\n      show(grid);\n    }\n  }\n  function resetGridInlineStyles() {\n    grid.style.height = \"\";\n    grid.style.overflow = \"\";\n    grid.style.transition = \"\";\n    grid.style.willChange = \"\";\n  }\n\n  // ---------- skeleton + fade-in ----------\n  function buildSkeletonCard() {\n    return `\n      <li class=\"card card--skel\">\n        <div class=\"card__media skel skel--media\"></div>\n        <div class=\"card__tags\">\n          <span class=\"tag skel skel--tag\"></span>\n          <span class=\"tag skel skel--tag\"></span>\n        </div>\n        <div class=\"skel skel--title\"></div>\n        <div class=\"skel skel--text\"></div>\n      </li>`;\n  }\n  function renderSkeleton(count) {\n    const n = Math.max(1, Number(count) || DEFAULT_LIMIT);\n    grid.innerHTML = new Array(n).fill(0).map(buildSkeletonCard).join(\"\");\n    show(grid);\n    hide(empty);\n    hide(pager);\n  }\n  function afterImagesFadeIn() {\n    const imgs = grid.querySelectorAll(\"img.img-fade\");\n    imgs.forEach((img) => {\n      const done = () => img.classList.add(\"is-loaded\");\n      if (img.complete && img.naturalWidth > 0) done();\n      else img.addEventListener(\"load\", done, { once: true });\n    });\n  }\n\n  // удержание высоты\n  let gridCleanupTimer = null;\n  function lockGridHeight(h) {\n    const hh = h ?? grid.getBoundingClientRect().height;\n    grid.style.willChange = \"height\";\n    grid.style.overflow = \"hidden\";\n    grid.style.transition = \"none\";\n    grid.style.height = `${Math.max(1, Math.round(hh || 0))}px`;\n  }\n  function unlockGridHeight() {\n    resetGridInlineStyles();\n  }\n  function swapGridContent(renderFn) {\n    renderFn();\n    void grid.offsetHeight;\n    const newH = grid.scrollHeight;\n    grid.style.transition = \"height 200ms ease\";\n    grid.style.height = `${newH}px`;\n    const onEnd = (e) => {\n      if (e.target !== grid || e.propertyName !== \"height\") return;\n      grid.removeEventListener(\"transitionend\", onEnd);\n      unlockGridHeight();\n    };\n    grid.addEventListener(\"transitionend\", onEnd);\n    clearTimeout(gridCleanupTimer);\n    gridCleanupTimer = setTimeout(unlockGridHeight, 400);\n  }\n\n  // ---------- rendering ----------\n  function buildCard(a) {\n    const id = a?.id || a?._id || a?.artistId || \"\";\n    const name = a?.strArtist || a?.name || \"Unknown\";\n    const img =\n      a?.strArtistThumb ||\n      a?.photo ||\n      a?.image ||\n      \"https://via.placeholder.com/960x540?text=No+Image\";\n    const about = a?.strBiographyEN || a?.about || \"\";\n    const tags = Array.isArray(a?.genres) ? a.genres : a?.genre ? [a.genre] : [];\n    const sizes = \"(min-width:1440px) 50vw, (min-width:768px) 704px, 100vw\";\n\n    return `\n      <li class=\"card\" data-id=\"${id}\">\n        <div class=\"card__media\">\n          <img\n            class=\"img-fade\"\n            src=\"${img}\"\n            srcset=\"${img} 1x, ${img} 2x\"\n            sizes=\"${sizes}\"\n            alt=\"${name}\"\n            loading=\"lazy\"\n          >\n        </div>\n        <div class=\"card__tags\">${tags\n          .map((t) => `<span class=\"tag\">${t}</span>`)\n          .join(\"\")}</div>\n        <h3 class=\"card__title\">${name}</h3>\n        <p class=\"card__text\">${about}</p>\n        <button class=\"card__link\" data-action=\"more\">\n          Learn More\n          ${icon(\"icon-icon_play_artists_sections\")}\n        </button>\n      </li>`;\n  }\n  function renderGrid(arr) {\n    grid.innerHTML = arr.map(buildCard).join(\"\");\n    afterImagesFadeIn();\n  }\n\n  function renderPager(page, totalPages) {\n    if (totalPages <= 0) {\n      pager.innerHTML = \"\";\n      hide(pager);\n      return;\n    }\n    if (totalPages === 1) {\n      pager.innerHTML = `<button class=\"active\" data-page=\"1\" disabled>1</button>`;\n      show(pager);\n      return;\n    }\n    const btn = (label, p, dis = false, act = false) =>\n      `<button ${dis ? \"disabled\" : \"\"} data-page=\"${p}\" class=\"${\n        act ? \"active\" : \"\"\n      }\">${label}</button>`;\n\n    const win = 2;\n    const from = Math.max(1, page - win);\n    const to = Math.min(totalPages, page + win);\n    const out = [];\n\n    out.push(btn(\"‹\", Math.max(1, page - 1), page === 1, false));\n    if (from > 1) {\n      out.push(btn(\"1\", 1, false, page === 1));\n      if (from > 2) out.push(`<button class=\"dots\">…</button>`);\n    }\n    for (let p = from; p <= to; p++) out.push(btn(String(p), p, false, p === page));\n    if (to < totalPages) {\n      if (to < totalPages - 1) out.push(`<button class=\"dots\">…</button>`);\n      out.push(btn(String(totalPages), totalPages, false, page === totalPages));\n    }\n    out.push(btn(\"›\", Math.min(totalPages, page + 1), page === totalPages, false));\n\n    pager.innerHTML = out.join(\"\");\n    show(pager);\n  }\n\n  // ---------- data ----------\n  async function loadGenres() {\n    try {\n      ddGenre?.classList.add(\"loading\");\n      ddGenreBtn?.setAttribute(\"aria-busy\", \"true\");\n      if (ddGenreBtn) ddGenreBtn.disabled = true;\n      ddGenreList.innerHTML = `\n        <li class=\"dd__loading\">\n          <span class=\"dd__spinner\" aria-hidden=\"true\"></span>\n          <span>Loading…</span>\n        </li>`;\n      const list = await fetchGenres();\n      ddGenreList.innerHTML = list\n        .map((g) => `<li data-val=\"${g}\">${g}</li>`)\n        .join(\"\");\n    } catch {\n      ddGenreList.innerHTML = `<li data-val=\"\">All Genres</li>`;\n    } finally {\n      ddGenre?.classList.remove(\"loading\");\n      ddGenreBtn?.removeAttribute(\"aria-busy\");\n      if (ddGenreBtn) ddGenreBtn.disabled = false;\n    }\n  }\n\n  async function loadArtists(allowRetry = true) {\n    const myId = ++reqId;\n\n    const { page, limit, genre, sort, q } = ArtistState.get();\n\n    lockGridHeight(grid.getBoundingClientRect().height);\n    renderSkeleton(limit);\n    hide(pager);\n\n    let list = [];\n    let total = 0;\n\n    try {\n      const server = await fetchArtists({\n        page,\n        limit,\n        genre: genre || \"\",\n        sort: sort || \"\",\n        name: q?.trim?.() || \"\",\n      });\n      if (myId !== reqId) return;\n      list = Array.isArray(server.artists) ? server.artists : [];\n      total = Number(server.totalArtists || list.length || 0);\n    } catch {\n      if (myId !== reqId) return;\n      list = [];\n      total = 0;\n    }\n\n    let totalPages = Math.max(1, Math.ceil(total / limit));\n    if (page > totalPages && allowRetry) {\n      ArtistState.setPage(totalPages);\n      return loadArtists(false);\n    }\n    if (page < 1 && allowRetry) {\n      ArtistState.setPage(1);\n      return loadArtists(false);\n    }\n\n    if (sort === \"asc\")\n      list = list\n        .slice()\n        .sort((a, b) => byName(a).localeCompare(byName(b)));\n    if (sort === \"desc\")\n      list = list\n        .slice()\n        .sort((a, b) => byName(b).localeCompare(byName(a)));\n\n    if (myId !== reqId) return;\n\n    if (!list.length) {\n      grid.innerHTML = \"\";\n      applyEmpty(true);\n      unlockGridHeight();\n      return;\n    }\n\n    applyEmpty(false);\n    swapGridContent(() => renderGrid(list));\n    renderPager(ArtistState.get().page, totalPages);\n  }\n\n  // ---------- dropdowns ----------\n  function closeDropdowns(except) {\n    [ddSort, ddGenre].forEach((dd) => {\n      if (dd !== except) {\n        dd.classList.remove(\"open\");\n        const ul = dd.querySelector(\".dd__list\");\n        if (ul) ul.style.display = \"none\";\n      }\n    });\n  }\n  function toggleDropdown(dd) {\n    const open = !dd.classList.contains(\"open\");\n    closeDropdowns(dd);\n    dd.classList.toggle(\"open\", open);\n    const ul = dd.querySelector(\".dd__list\");\n    if (ul) ul.style.display = open ? \"block\" : \"none\";\n  }\n\n  // ---------- UI events ----------\n  toggleBtn?.addEventListener(\"click\", () => {\n    UISound.tap();\n    const st = ArtistState.get();\n    ArtistState.setMobilePanel(!st.isMobilePanelOpen);\n    syncPanelMode();\n  });\n  addEventListener(\"resize\", syncPanelMode);\n\n  ddSortBtn?.addEventListener(\"click\", () => {\n    UISound.tap();\n    toggleDropdown(ddSort);\n  });\n  ddGenreBtn?.addEventListener(\"click\", () => {\n    UISound.tap();\n    toggleDropdown(ddGenre);\n  });\n  document.addEventListener(\"click\", (e) => {\n    if (!e.target.closest(\".dd\")) closeDropdowns();\n  });\n\n  ddSortList?.addEventListener(\"click\", (e) => {\n    const li = e.target.closest(\"li\");\n    if (!li) return;\n    UISound.tap();\n    ArtistState.setSort(li.dataset.val || \"\");\n    toggleDropdown(ddSort);\n    loadArtists();\n  });\n\n  ddGenreList?.addEventListener(\"click\", (e) => {\n    const li = e.target.closest(\"li\");\n    if (!li) return;\n    UISound.tap();\n    const v = li.dataset.val || \"\";\n    ArtistState.setGenre(v === \"All Genres\" ? \"\" : v);\n    toggleDropdown(ddGenre);\n    loadArtists();\n    ddSortBtn?.focus();\n  });\n\n  function doSearch() {\n    UISound.tap();\n    ArtistState.setQuery(searchInput?.value.trim() || \"\");\n    loadArtists();\n  }\n  searchBtn?.addEventListener(\"click\", doSearch);\n  searchInput?.addEventListener(\"keydown\", (e) => {\n    if (e.key === \"Enter\") doSearch();\n  });\n\n  function resetAll() {\n    ArtistState.reset();\n    // восстановим лимит в соответствии с видом\n    const mode = getSavedView();\n    ArtistState.setLimit(mode === \"list\" ? LIST_LIMIT : DEFAULT_LIMIT);\n    if (searchInput) searchInput.value = \"\";\n    closeDropdowns();\n    loadArtists();\n  }\n  resetBtn?.addEventListener(\"click\", () => {\n    UISound.tap();\n    resetAll();\n  });\n  resetBtnSm?.addEventListener(\"click\", () => {\n    UISound.tap();\n    resetAll();\n    ArtistState.setMobilePanel(false);\n    syncPanelMode();\n  });\n  root\n    .querySelector(\"#empty-reset\")\n    ?.addEventListener(\"click\", () => {\n      UISound.tap();\n      resetAll();\n    });\n\n  pager?.addEventListener(\"click\", (e) => {\n    const b = e.target.closest(\"button[data-page]\");\n    if (!b || b.disabled) return;\n    const p = Number(b.dataset.page) || 1;\n    if (p === ArtistState.get().page) return;\n    UISound.page();\n    scrollToGridTop();\n    ArtistState.setPage(p);\n    loadArtists();\n  });\n\n  // ---------- ensure ListView button (desktop + mobile) ----------\n  const sectionRoot = root.closest(\".artists1\") || root;\n\n  function ensureViewToggle() {\n    let btn = viewToggle;\n    if (!btn) {\n      btn = document.createElement(\"button\");\n      btn.id = \"view-toggle\";\n      btn.type = \"button\";\n      btn.className = \"btn view-toggle\"; // базовый класс; даже без css будет видно\n      // сделаем чтобы точно было видно на мобилке\n      btn.style.display = \"inline-flex\";\n      btn.style.alignItems = \"center\";\n      btn.style.gap = \"6px\";\n      btn.style.padding = \"8px 12px\";\n      btn.style.borderRadius = \"8px\";\n      btn.style.border = \"1px solid rgba(255,255,255,0.25)\";\n      btn.style.background = \"transparent\";\n      btn.style.color = \"var(--color-white, #fff)\";\n      btn.style.font =\n        \"500 14px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif\";\n\n      // куда вставляем\n      const anchor = panel || root;\n      if (anchor.firstElementChild) anchor.insertBefore(btn, anchor.firstElementChild);\n      else anchor.appendChild(btn);\n      viewToggle = btn;\n    }\n    return btn;\n  }\n\n  function applyView(mode) {\n    // классы на корне секции\n    const listOn = mode === \"list\";\n    sectionRoot.classList.toggle(\"view-list\", listOn);\n    sectionRoot.classList.toggle(\"view-grid\", !listOn);\n\n    // подпись и aria\n    viewToggle.setAttribute(\"aria-pressed\", String(listOn));\n    viewToggle.textContent = listOn ? \"Default view\" : \"List view\";\n\n    // лимит карточек\n    ArtistState.setLimit(listOn ? LIST_LIMIT : DEFAULT_LIMIT);\n    saveView(mode);\n  }\n\n  // создать/найти кнопку\n  ensureViewToggle();\n\n  // навесить поведение\n  viewToggle.addEventListener(\"click\", () => {\n    UISound.tap();\n    const next = sectionRoot.classList.contains(\"view-list\") ? \"grid\" : \"list\";\n    applyView(next);\n    // после смены вида логично обновить выдачу с новым лимитом\n    ArtistState.setPage(1);\n    loadArtists();\n  });\n\n  // инициализация режима при первом старте\n  applyView(getSavedView());\n\n  // ---------- модалка и зум ----------\n  grid.addEventListener(\"click\", (e) => {\n    const btn = e.target.closest('[data-action=\"more\"]');\n    if (btn) {\n      const id = btn.closest(\".card\")?.dataset?.id;\n      if (!id) return;\n      UISound.tap();\n      modalApi.openFor(id);\n      return;\n    }\n    const img = e.target.closest(\".card__media img\");\n    if (img) {\n      UISound.tap();\n      const src = img.currentSrc || img.src || img.getAttribute(\"src\") || \"\";\n      openZoom(src, img.getAttribute(\"alt\") || \"\");\n    }\n  });\n\n  // ---------- init ----------\n  syncPanelMode();\n  loadGenres();\n  loadArtists();\n}\n","// URL-sync для секции Artists: читает состояние из query при старте,\n// и поддерживает актуальный query при изменении state (replaceState).\n\nimport { getState, setState, subscribe } from \"./state.js\";\n\nfunction parseQuery() {\n  const p = new URLSearchParams(location.search);\n  const q = (p.get(\"q\") || \"\").trim();\n  const genre = p.get(\"genre\") || \"\";\n  const sort = p.get(\"sort\") || \"\";\n  const page = Math.max(1, Number(p.get(\"page\") || 1));\n  return { q, genre, sort, page };\n}\n\nfunction buildQuery(s) {\n  const p = new URLSearchParams();\n  if (s.q) p.set(\"q\", s.q);\n  if (s.genre) p.set(\"genre\", s.genre);\n  if (s.sort) p.set(\"sort\", s.sort);\n  if (s.page && s.page !== 1) p.set(\"page\", String(s.page));\n  return p.toString();\n}\n\nexport function initRouter() {\n  \n  const urlState = parseQuery();\n  const cur = getState();\n  const patch = {};\n  let changed = false;\n  for (const k of [\"q\",\"genre\",\"sort\",\"page\"]) {\n    if (urlState[k] !== undefined && urlState[k] !== cur[k]) {\n      patch[k] = urlState[k];\n      changed = true;\n    }\n  }\n  if (changed) setState(patch);\n\n  \n  let lastQS = null;\n  subscribe((s) => {\n    const qs = buildQuery(s);\n    if (qs === lastQS) return;\n    lastQS = qs;\n    const url = qs ? `?${qs}` : location.pathname;\n    history.replaceState(null, \"\", url);\n  });\n}\n","// Предзагрузка данных артиста при hover на “Learn more” >150мс.\n\nimport { fetchArtist, fetchArtistAlbums } from \"./api.js\";\n\nconst cache = new Map(); // id -> { artist, albums, ts }\n\nexport function getPrefetched(id) {\n  return cache.get(String(id));\n}\n\nexport function initPrefetch(root) {\n  const grid = root.querySelector(\"#artists-grid\");\n  if (!grid) return;\n\n  let hoverTimer = null;\n  let hoverId = null;\n\n  function schedulePrefetch(id) {\n    clearTimeout(hoverTimer);\n    hoverTimer = setTimeout(async () => {\n      try {\n        if (cache.has(id)) return;\n        const [artist, albums] = await Promise.all([\n          fetchArtist(id),\n          fetchArtistAlbums(id),\n        ]);\n        cache.set(id, { artist, albums, ts: Date.now() });\n      } catch { /* тихо игнорим */ }\n    }, 150);\n  }\n\n  grid.addEventListener(\"mouseenter\", (e) => {\n    const btn = e.target.closest('[data-action=\"more\"]');\n    if (!btn) return;\n    const id = btn.closest(\".card\")?.dataset?.id;\n    if (!id) return;\n    hoverId = String(id);\n    schedulePrefetch(hoverId);\n  }, true);\n\n  grid.addEventListener(\"mouseleave\", (e) => {\n    if (e.target.closest('[data-action=\"more\"]')) {\n      clearTimeout(hoverTimer);\n      hoverTimer = null;\n      hoverId = null;\n    }\n  }, true);\n}\n","import { initGrid } from \"./grid.js\";\nimport { createArtistModal } from \"./modal.js\";\nimport { initRouter } from \"./router.js\";\nimport { initPrefetch } from \"./prefetch.js\";\n\nexport function initArtists(root = document.querySelector(\"#artists-section\")) {\n  if (!root) return;\n\n  // URL-sync сначала (восстановит состояние до начальной загрузки)\n  initRouter(root);\n\n  // Модалка (возвращает open/close)\n  const modal = createArtistModal(root);\n\n  // Prefetch \"Learn more\" (ускоряет открытие модалки)\n  initPrefetch(root);\n\n  // Грид (передаём модалку для открытия)\n  initGrid(root, { openModal: modal.open });\n}\n","// src/js/artists/index.js\n// Апгрейд радио: большой пул, сбор ID с страницы, кэш, анти-повтор.\n// Ничего не ломает существующие части: initArtists + мини-плеер.\n\nimport { initArtists } from \"./features/init.js\";\nimport { createMiniPlayer } from \"./features/player.js\";\n\n/* -------------------- утилиты -------------------- */\nfunction getYouTubeId(urlOrId) {\n  if (!urlOrId) return \"\";\n  if (/^[\\w-]{11}$/.test(urlOrId)) return urlOrId;\n  try {\n    const u = new URL(urlOrId, location.href);\n    if (/youtu\\.be$/.test(u.hostname)) return u.pathname.slice(1);\n    if (u.searchParams.get(\"v\")) return u.searchParams.get(\"v\");\n    const m = u.pathname.match(/\\/(embed|shorts|v)\\/([^/?#]+)/);\n    return m ? m[2] : \"\";\n  } catch {\n    return \"\";\n  }\n}\nconst uniq = (arr) => Array.from(new Set(arr.filter(Boolean)));\nfunction shuffle(a) {\n  const arr = a.slice();\n  for (let i = arr.length - 1; i > 0; i--) {\n    const j = (Math.random() * (i + 1)) | 0;\n    [arr[i], arr[j]] = [arr[j], arr[i]];\n  }\n  return arr;\n}\n\n/* -------------------- seed-пул -------------------- */\n// Можно смело дополнять своими ID. Дубликаты автоматически фильтруются.\nconst SEED_IDS = uniq([\n  // Твои прежние ID\n  \"Zi_XLOBDo_Y\",\"3JZ_D3ELwOQ\",\"fRh_vgS2dFE\",\"OPf0YbXqDm0\",\"60ItHLz5WEA\",\n  \"2Vv-BfVoq4g\",\"kXYiU_JCYtU\",\"UceaB4D0jpo\",\"RubBzkZzpUA\",\"kJQP7kiw5Fk\",\n  \"CevxZvSJLk8\",\"pRpeEdMmmQ0\",\"IcrbM1l_BoI\",\"YVkUvmDQ3HY\",\"hT_nvWreIhg\",\n  \"09R8_2nJtjg\",\"uelHwf8o7_U\",\"JGwWNGJdvx8\",\"YQHsXMglC9A\",\"NmugSMBh_iI\",\n  \"LrUvu1mlWco\",\"hLQl3WQQoQ0\",\"RgKAFK5djSk\",\"SlPhMPnQ58k\",\"oRdxUFDoQe0\",\n  \"09z7j-LPz1E\",\"Pkh8UtuejGw\",\"tt2k8PGm-TI\",\"lY2yjAdbvdQ\",\"pXRviuL6vMY\",\n  \"09tj3yqpP5g\",\"nfs8NYg7yQM\",\"nCkpzqqog4k\",\"M7lc1UVf-VE\",\n\n  // Дополнения (разнообразие)\n  \"fLexgOxsZu0\",\"2vjPBrBU-TM\",\"JGwWNGJdvx8\",\"9bZkp7q19f0\",\"e-ORhEE9VVg\",\n  \"hLQl3WQQoQ0\",\"OPf0YbXqDm0\",\"dQw4w9WgXcQ\",\"Zi_XLOBDo_Y\",\"gCYcHz2k5x0\",\n  \"ktvTqknDobU\",\"ub82Xb1C8os\",\"ktvTqknDobU\",\"fKopy74weus\",\"uelHwf8o7_U\",\n  \"Qv5fqunQ_4I\",\"IcrbM1l_BoI\",\"2vjPBrBU-TM\",\"kXYiU_JCYtU\",\"CevxZvSJLk8\",\n  \"kJQP7kiw5Fk\",\"hT_nvWreIhg\",\"vNoKguSdy4Y\",\"0KSOMA3QBU0\",\"lp-EO5I60KA\",\n  \"DK_0jXPuIr0\",\"tVj0ZTS4WF4\",\"6fVE8kSM43I\",\"SlPhMPnQ58k\",\"6Ejga4kJUts\",\n  \"JGwWNGJdvx8\",\"gGdGFtwCNBE\",\"YVkUvmDQ3HY\",\"rYEDA3JcQqw\",\"AtKZKl7Bgu0\",\n  \"0KSOMA3QBU0\",\"ktvTqknDobU\",\"hT_nvWreIhg\",\"eVTXPUF4Oz4\",\"kffacxfA7G4\"\n]);\n\n/* -------------------- кэш пула в localStorage -------------------- */\nconst LS_KEY_POOL = \"am.radio.pool\";\nconst LS_KEY_LAST = \"am.radio.last\";\n\nfunction readPoolLS() {\n  try {\n    const raw = localStorage.getItem(LS_KEY_POOL);\n    const arr = raw ? JSON.parse(raw) : [];\n    return Array.isArray(arr) ? uniq(arr) : [];\n  } catch {\n    return [];\n  }\n}\nfunction savePoolLS(arr) {\n  try {\n    localStorage.setItem(LS_KEY_POOL, JSON.stringify(uniq(arr).slice(0, 800)));\n  } catch {}\n}\nfunction addToPoolLS(ids) {\n  if (!ids?.length) return;\n  const cur = new Set(readPoolLS());\n  ids.forEach((id) => cur.add(id));\n  savePoolLS([...cur]);\n}\n\n/* -------------------- сбор ID из DOM (модалка и т.п.) -------------------- */\nfunction collectFromDOM(root = document) {\n  const out = new Set();\n  root.querySelectorAll('a[href*=\"youtu\"], a.yt').forEach((a) => {\n    const href = a.getAttribute(\"href\") || \"\";\n    const id = getYouTubeId(href);\n    if (id) out.add(id);\n  });\n  return [...out];\n}\nfunction installCollector() {\n  // стартовая выборка\n  addToPoolLS(collectFromDOM());\n\n  // наблюдаем за добавлениями (модалки, динамика и т.д.)\n  const mo = new MutationObserver((mutations) => {\n    let added = [];\n    for (const m of mutations) {\n      if (!m.addedNodes) continue;\n      m.addedNodes.forEach((n) => {\n        if (n.nodeType !== 1) return; // ELEMENT_NODE\n        added = added.concat(collectFromDOM(n));\n      });\n    }\n    if (added.length) addToPoolLS(added);\n  });\n  mo.observe(document.documentElement, { childList: true, subtree: true });\n}\n\n/* -------------------- сбор итогового пула -------------------- */\nfunction buildPool() {\n  // объединяем: seed + кэш + то, что уже в DOM\n  const mem = readPoolLS();\n  const dom = collectFromDOM();\n  const pool = uniq([...SEED_IDS, ...mem, ...dom]);\n  return pool;\n}\n\n/* -------------------- радио-логика -------------------- */\nfunction startMixRadio(player) {\n  const pool = buildPool();\n  if (!pool.length) return;\n\n  // большая перемешанная очередь\n  let order = shuffle(pool);\n\n  // анти-повтор стартового: если первый совпал с прошлым — сдвигаем\n  const last = localStorage.getItem(LS_KEY_LAST);\n  if (last && order.length > 1 && order[0] === last) {\n    order.push(order.shift());\n  }\n  localStorage.setItem(LS_KEY_LAST, order[0]);\n\n  // даём плееру целую очередь, он сам пролистывает и лупит\n  // (loop:true — бесконечно; shuffle:false, т.к. уже перемешали)\n  player.openQueue(order, { shuffle: false, loop: true, startIndex: 0 });\n}\n\n/* -------------------- bootstrap -------------------- */\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  try { initArtists(); } catch {}\n\n  const player = createMiniPlayer();\n\n  // собираем ID на лету\n  installCollector();\n\n  // кнопка «Mix Radio / Next»\n  const btn = document.querySelector(\"#random-radio\");\n  if (btn) {\n    btn.addEventListener(\"click\", (e) => {\n      e.preventDefault();\n      // если плеер ещё не активен — стартуем радио, иначе — Next\n      if (!player.isActive?.()) startMixRadio(player);\n      else player.next?.();\n    });\n  }\n});\n","const refs = {\n  openBtn: document.querySelector('[data-menu-open]'),\n  closeBtn: document.querySelector('[data-menu-close]'),\n  menu: document.querySelector('[data-menu]'),\n  links: document.querySelectorAll('[data-menu-link]'),\n  logos: document.querySelectorAll('.header-logo'),\n  header: document.querySelector('.header'),\n};\n\nfunction openMenu() {\n  if (!refs.menu) return;\n  refs.menu.hidden = false;\n  refs.menu.classList.add('show');\n  document.body.style.overflow = 'hidden';\n  refs.openBtn?.setAttribute('aria-expanded', 'true');\n}\n\nfunction closeMenu() {\n  return new Promise(resolve => {\n    if (!refs.menu) return resolve();\n    refs.menu.classList.remove('show');\n    setTimeout(() => {\n      refs.menu.hidden = true;\n      document.body.style.overflow = '';\n      refs.openBtn?.setAttribute('aria-expanded', 'false');\n      resolve();\n    }, 400);\n  });\n}\n\n/* ---------- header offset helpers ---------- */\nfunction getHeaderOffset() {\n  return (refs.header?.offsetHeight || 80) + 8;\n}\nfunction applyScrollPadding() {\n  document.documentElement.style.scrollPaddingTop = `${getHeaderOffset()}px`;\n}\napplyScrollPadding();\nwindow.addEventListener('resize', () => requestAnimationFrame(applyScrollPadding));\n\n/* ---------- custom smooth scroll (no teleports) ---------- */\nfunction smoothScroll(targetHref, duration = 500) {\n  const raw = (targetHref || '').replace('#', '');\n  const el = document.getElementById(raw) || document.getElementById(`${raw}-section`);\n  if (!el) return;\n\n  const headerOffset = getHeaderOffset();\n  const targetY = el.getBoundingClientRect().top + window.pageYOffset - headerOffset;\n\n  const startY = window.pageYOffset;\n  const diff = targetY - startY;\n  let t0 = null;\n\n  const ease = t => (t < 0.5 ? 2 * t * t : 1 - Math.pow(-2 * t + 2, 2) / 2);\n\n  function step(ts) {\n    if (t0 === null) t0 = ts;\n    const p = Math.min(1, (ts - t0) / duration);\n    window.scrollTo(0, startY + diff * ease(p));\n    if (p < 1) {\n      requestAnimationFrame(step);\n    } else {\n      // NEW: переносим фокус на секцию, чтобы ссылка потеряла :focus\n      el.setAttribute('tabindex', '-1');\n      el.focus({ preventScroll: true });\n      setTimeout(() => el.removeAttribute('tabindex'), 0);\n    }\n  }\n  requestAnimationFrame(step);\n}\n\n/* ---------- menu events ---------- */\nrefs.openBtn?.addEventListener('click', openMenu);\nrefs.closeBtn?.addEventListener('click', closeMenu);\n\nrefs.logos.forEach(logo => {\n  logo.addEventListener('click', e => {\n    if (logo.closest('.mobile-menu')) {\n      e.preventDefault();\n      closeMenu();\n      setTimeout(() => {\n        window.location.href = logo.getAttribute('href');\n      }, 400);\n    }\n  });\n});\n\nrefs.menu?.addEventListener('click', e => {\n  if (e.target === refs.menu) {\n    closeMenu();\n  }\n});\n\ndocument.addEventListener('keydown', e => {\n  if (e.key === 'Escape' && refs.menu?.classList.contains('show')) {\n    closeMenu();\n  }\n});\n\n/* ---------- scroll-spy with IO ---------- */\nconst navLinks = document.querySelectorAll('.header-nav-link, .mobile-menu-nav-link');\n\nconst linkTargets = new Map();\nnavLinks.forEach(a => {\n  const href = (a.getAttribute('href') || '').trim();\n  if (!href.startsWith('#')) return;\n  const rawId = href.slice(1);\n  const el = document.getElementById(rawId) || document.getElementById(`${rawId}-section`);\n  if (!el) return;\n  if (!linkTargets.has(el)) linkTargets.set(el, []);\n  linkTargets.get(el).push(a);\n});\n\nlet currentEl = null;\nfunction setActiveByEl(el) {\n  if (!el || currentEl === el) return;\n  navLinks.forEach(a => a.classList.remove('active'));\n  (linkTargets.get(el) || []).forEach(a => a.classList.add('active'));\n  currentEl = el;\n}\n\nlet lockUntil = 0;\nconst LOCK_MS = 700;\nconst isLocked = () => Date.now() < lockUntil;\n\nlet io;\nfunction initScrollSpy() {\n  if (io) io.disconnect();\n\n  const rootMargin = `-${getHeaderOffset()}px 0px -55% 0px`;\n  const visibleRatio = new Map();\n\n  io = new IntersectionObserver(\n    entries => {\n      entries.forEach(en => {\n        visibleRatio.set(en.target, en.isIntersecting ? en.intersectionRatio : 0);\n      });\n      if (isLocked()) return;\n      const best = [...visibleRatio.entries()].sort((a, b) => b[1] - a[1])[0];\n      if (best && best[1] > 0) setActiveByEl(best[0]);\n    },\n    { root: null, rootMargin, threshold: [0, 0.25, 0.5, 0.75, 1] }\n  );\n\n  linkTargets.forEach((_, el) => io.observe(el));\n}\ninitScrollSpy();\nwindow.addEventListener('resize', () => requestAnimationFrame(initScrollSpy));\n\n/* ---------- nav handlers ---------- */\n// Desktop: не трогаем мобильные (у них есть data-menu-link)\nnavLinks.forEach(a => {\n  a.addEventListener('click', (e) => {\n    if (a.matches('[data-menu-link]')) return;\n    const href = (a.getAttribute('href') || '').trim();\n    if (!href.startsWith('#')) return;\n\n    e.preventDefault();\n    a.blur();                      // NEW: снимаем :focus с кликнутой ссылки\n\n    const raw = href.slice(1);\n    const el = document.getElementById(raw) || document.getElementById(`${raw}-section`);\n    if (!el) return;\n\n    setActiveByEl(el);\n    lockUntil = Date.now() + LOCK_MS;\n    smoothScroll(href);\n  });\n});\n\n// Mobile: ждём закрытие меню, снимаем фокус, потом скроллим\nrefs.links.forEach(link =>\n  link.addEventListener('click', async e => {\n    e.preventDefault();\n    link.blur();                   // NEW: снимаем :focus с мобильной ссылки\n    const targetId = link.getAttribute('href');\n    await closeMenu();\n    smoothScroll(targetId);\n  })\n);\n\nwindow.addEventListener('load', () => {\n  applyScrollPadding();\n  if (location.hash) {\n    setTimeout(() => smoothScroll(location.hash), 0);\n  }\n});\n","import 'css-star-rating/css/star-rating.css';\nimport Swiper from 'swiper';\nimport 'swiper/css';\nimport 'swiper/css/navigation';\nimport 'swiper/css/pagination';\n\nimport iziToast from 'izitoast';\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\n\nconst overlay = document.querySelector(\".overlay\");\nconst openBtn = document.querySelector(\".feedback-btn\")\nconst closeBtn = document.querySelector(\".close-icon\");\nconst form = document.querySelector(\"#feedback-form\");\nconst container = document.querySelector(\".feedback-section\");\nconst inputName = document.querySelector(\".form-input-name\");\nconst inputMessage = document.querySelector(\".form-input-message\");\nconst STORAGE_KEY = \"myFeedback\";\n\n\n// modal\nlet scrollY = 0;\nopenBtn.addEventListener(\"click\", (e) => {\n  e.preventDefault();\n  scrollY = window.scrollY;\n  document.body.style.position = \"fixed\";\n  document.body.style.top = `-${scrollY}px`;\n  document.body.style.left = \"0\";\n  document.body.style.right = \"0\";\n    overlay.classList.remove(\"hidden\");\n  container.classList.add(\"hidden\");\n  \n\n  dataFromLocalStorage();\n})\n\ncloseBtn.addEventListener(\"click\", (e) => {\n    overlay.classList.add(\"hidden\");\n  container.classList.remove(\"hidden\");\n  document.body.style.position = \"\";\n  window.scrollTo(0, scrollY);\n  createStars(document.getElementById(\"customer-rating\", 0));\n});\n\noverlay.addEventListener(\"click\", (e) => {\n  if (e.target === overlay) {\n    overlay.classList.add(\"hidden\")\n    container.classList.remove(\"hidden\");\n    document.body.style.position = \"\";\n  window.scrollTo(0, scrollY);\n  createStars(document.getElementById(\"customer-rating\", 0));\n  }\n});\ndocument.addEventListener(\"keydown\", (e) => {\n  if (e.key === \"Escape\") {\n    overlay.classList.add(\"hidden\")\n    container.classList.remove(\"hidden\")\n    document.body.style.position = \"\";\n  window.scrollTo(0, scrollY);\n  createStars(document.getElementById(\"customer-rating\", 0));\n  }\n})\n\n// stars\nfunction createStars(container, rating) {\n  container.innerHTML = \"\";\n  for (let i = 1; i <= 5; i++) {\n    const star = document.createElement(\"span\");\n    star.classList.add(\"star\");\n    if (i <= rating) star.classList.add(\"filled\");\n    container.appendChild(star);\n    if (container.id === \"customer-rating\") {\n      star.addEventListener(\"click\", (e) => {\n        container.dataset.rating = i;\n        createStars(container, i);\n        saveToLocalStorage();\n      })\n      star.addEventListener('mouseenter', (e) => {\n        hoveredStar(container, i)\n      })\n      star.addEventListener('mouseleave', (e) => {\n        const savedRating = parseInt(formRating.dataset.rating) || 0;\n        createStars(container, savedRating);\n      })\n    }\n  }\n}\n\nfunction hoveredStar(container, upTo) {\n  const stars = container.querySelectorAll(\".star\");\n  stars.forEach((star, index) => {\n    if (index < upTo) {\n      star.classList.add(\"filled\");\n    } else {\n      star.classList.remove(\"filled\")\n    }\n  });\n}\n\n// data from API\nconst formRating = document.getElementById(\"customer-rating\");\ncreateStars(formRating, parseInt(formRating.dataset.rating) || 0);\n\nconst swiper = new Swiper('.swiper', {\n  slidesPerView: 1,\n  spaceBetween: 20,\n  loop: false,\n        grabCursor: true,\n        navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev', },\n  pagination: { el: '.swiper-pagination', clickable: true, },\n});\ndocument.querySelector('.swiper-button-prev').addEventListener('click', () => {\n  swiper.slidePrev();\n})\ndocument.querySelector('.swiper-button-next').addEventListener('click', () => {\n  swiper.slideNext();\n})\n\n//dots\nconst dots = document.querySelector('.swiper-pagination');\ndots.innerHTML = `\n  <span class=\"swiper-dots\"></span>\n    <span class=\"swiper-dots\"></span>\n  <span class=\"swiper-dots\"></span>`\n\nfunction activateDot(dotNumber) {\n  const dots = document.querySelectorAll(\".swiper-dots\");\n  dots.forEach(dot => dot.classList.remove('active'));\n  if (dots[dotNumber - 1]) {\n    dots[dotNumber - 1].classList.add('active');\n  }\n}\n  \nfunction getDotIndex(index) {\n  if (index === 0) {\n    return 1;\n  } else if (index === 9) {\n    return 3;\n  } else {\n    return 2;\n  }\n}\n\nactivateDot(getDotIndex(swiper.realIndex));\n\nconst dotElements = document.querySelectorAll('.swiper-dots');\ndotElements.forEach((dot, index) => {\n  dot.addEventListener('click', (e) => {\n    let slideIndex = 0;\n\n    if (index === 0) {\n      slideIndex = 0;\n    } else if (index === 1) {\n      slideIndex = 1;\n    } else if (index === 2) {\n      slideIndex = 9;\n    }\n    swiper.slideTo(slideIndex);\n  })\n})\n\nswiper.on('slideChange', (e) => {\n  const currentIndex = swiper.realIndex\n  activateDot(getDotIndex(currentIndex))\n});\n\nasync function loadReviews() {\n  const wrapper = document.querySelector(\".swiper-wrapper\");\n  try {\n    const data = await fetch(\"https://sound-wave.b.goit.study/api/feedbacks\");\n    const json = await data.json();\n    const feedbacks = json.data.slice(0, 10);\n    feedbacks.forEach((feedback, index) => {\n      const stars = Math.round(feedback.rating);\n\n      const slide = document.createElement(\"div\");\n      slide.classList.add(\"swiper-slide\")\n\n      slide.innerHTML = `<div class=\"rating\" id=\"rating-${index}\" data-rating=\"${stars}\"></div>\n                <div class=\"feedback\">\n                    <p class=\"customer-feedback\">${feedback.descr}</p>\n                    <h3 class=\"customer-name\">${feedback.name}</h3>\n                </div>`;\n      wrapper.appendChild(slide);\n      const starContainer = slide.querySelector(\".rating\");\n      createStars(starContainer, stars);\n    });\nswiper.update()\n  } catch (err) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Bad request (invalid request params)'\n    })\n  }\n}\n\n// data to localStorage\nfunction saveToLocalStorage() {\n  const params = {\n    name: inputName.value.trim(),\n    message: inputMessage.value.trim(),\n    rating: Math.round(formRating.dataset.rating) || 0,\n  };\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(params));\n}\n\n// data from localStorage\nfunction dataFromLocalStorage() {\n  const savedData = JSON.parse(localStorage.getItem(STORAGE_KEY));\n  if (!savedData) {\n    return;\n  }\n  if (savedData.name) {\n    inputName.value = savedData.name;\n  }\n  if (savedData.message) {\n    inputMessage.value = savedData.message;\n  }\n  if (savedData.rating) {\n    formRating.dataset.rating = savedData.rating;\n  }\n  createStars(formRating, savedData.rating);\n}\n\n//reset localStorage\nfunction resetLocalStorage() {\n  localStorage.removeItem(STORAGE_KEY);\n  form.reset();\n  formRating.dataset.rating = 0;\n  createStars(formRating, 0);\n}\n\n// data to API\nform.addEventListener(\"submit\", async (e) => {\n  e.preventDefault();\n  const name = form.querySelector(\".form-input-name\").value.trim();\n  const message = form.querySelector(\".form-input-message\").value.trim()\n  const rating = Math.round(formRating.dataset.rating) || 0;\n  console.log(\"Name:\", name);\n  console.log(\"Message:\", message);\n  console.log(\"Rating:\", rating);\n\n    if (!name || name.length < 2 || name.length > 16) {\n      return iziToast.error({ message: 'Shortest name - 2 letters; Largest name - 16 letters' })\n  };\n  if (!message || message.length < 10 || message.length > 512) {\n    return iziToast.error({ message: 'Min message - 10 symbols; Max message - 512 symbols' })\n  }\n  if (rating < 1 || rating > 5) {\n    return iziToast.error({ message: \"Rating must be between '1' and '5'\" })\n  }\n  try {\n    const response = await fetch(\"https://sound-wave.b.goit.study/api/feedbacks\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Accept\": \"application/json\",\n      },\n      body: JSON.stringify({\n        name: name,\n        descr: message,\n        rating: rating,\n      })\n      \n    })\n    \n    if (!response.ok) {\n      iziToast.error({\n        title: 'Error:',\n        message: '${response.status}'});\n    } \n\n    resetLocalStorage();\n    overlay.classList.add(\"hidden\");\n    container.classList.remove(\"hidden\");\n    document.body.classList.remove(\"no-scroll\");\n    loadReviews();\n  } catch (err) {\n\n    iziToast.error({ message: 'Bad request (invalid request body)' })\n  }\n})\ndocument.addEventListener(\"DOMContentLoaded\", loadReviews);","// ГЛОБАЛЬНЫЕ SFX ДЛЯ ВСЕГО САЙТА\n// Подключите один раз в main.js:  import \"./js/global-sfx.js\";\nimport { UISound } from \"./artists/lib/sound.js\"; // путь под ваш проект\n\n// ===== Конфиг =====\nconst CLICKABLE_SELECTOR = [\n  'a[href]',\n  'button',\n  '[role=\"button\"]',\n  'input[type=\"button\"]',\n  'input[type=\"submit\"]',\n  'input[type=\"reset\"]',\n  'summary',\n  '.sfx-click'          // опциональный «маркер-класс»\n].join(',');\n\n// Где НЕ играть (ползунки, драг-зоны и т.п.)\nconst IGNORE_SELECTOR = [\n  '.no-sfx',\n  '[data-sfx=\"off\"]',\n  '[disabled],[aria-disabled=\"true\"]',\n  'input[type=\"range\"]',\n  '.am-player__dragzone', // ваша верхняя зона перетаскивания плеера\n].join(',');\n\n// ===== Сервис =====\nconst SFX = {\n  enabled: localStorage.getItem('sfx') !== 'off',\n  lastAt: 0,\n  playOnce() {\n    if (!this.enabled) return;\n    const now = performance.now();\n    if (now - this.lastAt < 80) return; // анти-дубль\n    this.lastAt = now;\n    try {\n      UISound?.tap?.(); // ваш текущий звук\n    } catch {\n      // Фолбэк мини-бипом (если вдруг UISound не инициализирован)\n      try {\n        const ctx = new (window.AudioContext || window.webkitAudioContext)();\n        const o = ctx.createOscillator();\n        const g = ctx.createGain();\n        o.type = 'triangle'; o.frequency.value = 660;\n        g.gain.setValueAtTime(0.06, ctx.currentTime);\n        g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.06);\n        o.connect(g).connect(ctx.destination); o.start(); o.stop(ctx.currentTime + 0.07);\n      } catch {}\n    }\n  },\n};\n\n// Глобальный обработчик кликов\ndocument.addEventListener('click', (e) => {\n  // только «настоящие» левые клики\n  if (!e.isTrusted || e.button !== 0 || e.metaKey || e.ctrlKey || e.altKey) return;\n\n  const el = e.target.closest(CLICKABLE_SELECTOR);\n  if (!el) return;\n  if (el.matches(IGNORE_SELECTOR)) return;\n\n  // Если элемент тащили (drag), браузер обычно не кидает click — но на всякий случай:\n  if (Math.abs((e.movementX || 0)) > 2 || Math.abs((e.movementY || 0)) > 2) return;\n\n  SFX.playOnce();\n}, { capture: true });\n\n// Клавиатурная активация (Enter/Space) — для a11y\ndocument.addEventListener('keydown', (e) => {\n  if (!SFX.enabled) return;\n  if (!(e.key === 'Enter' || e.key === ' ')) return;\n\n  const el = e.target.closest(CLICKABLE_SELECTOR);\n  if (!el || el.matches(IGNORE_SELECTOR)) return;\n\n  SFX.playOnce();\n}, { capture: true });\n\n// Публичный тумблер (можно привязать к настройкам)\nwindow.SFX = {\n  enable()  { SFX.enabled = true;  localStorage.setItem('sfx', 'on');  },\n  disable() { SFX.enabled = false; localStorage.setItem('sfx', 'off'); },\n  toggle()  { SFX.enabled ? this.disable() : this.enable(); },\n};\n"],"names":["IS_DEV","logWarn","args","api","axios","fetchArtists","page","limit","genre","sort","name","params","s","g","n","data","err","_a","fetchGenres","names","fetchArtist","id","fetchArtistAlbums","ctx","master","comp","postLP","inited","init","AC","unlock","resume","tap","now","durNoise","nsrc","nbuf","ch","i","t","bp","hp","ng","osc","og","low","lg","UISound","normId","o","normGenres","NOPHOTO","normArtist","normTrack","normAlbum","a","rawTracks","res","_fetchArtists","artists","totalArtists","_fetchGenres","_fetchArtist","obj","_fetchArtistAlbums","STORAGE_KEY","initial","state","storageLoaded","listeners","canUseStorage","k","loadFromStorage","raw","saveToStorage","notify","snap","fn","subscribe","ArtistState","p","v","on","getState","setState","patch","next","depth","savedY","lockScroll","unlockScroll","force","emergencyUnlock","_instance","loadYTAPI","rej","isIOS","getYouTubeId","urlOrId","u","m","clamp","b","shuffleArr","arr","j","fmtTimeSec","sec","createMiniPlayer","dock","bubble","host","btnClose","btnHide","btnPlay","btnPrev","btnNext","btnMute","vol","prog","tCur","tDur","dragzone","aYTlink","yt","ready","duration","timer","muted","volVal","userSeeking","queue","qi","loop","DOCK_KEY","dockDrag","BUBBLE_KEY","bubbleDragging","bubbleStart","_bubblePos","watchdogId","uiShow","hideBubble","uiMin","showBubble","uiPlayIcon","isPlaying","uiMuteIcon","isMuted","uiSetTime","cur","dur","clearTimer","startTimer","clearWatchdog","skipWithDelay","ms","autoNext","ensureYT","setBubblePulse","setBubbleAmp","e","playByIndex","idx","getVP","w","h","_b","clampDock","rect","left","top","restoreDockPos","pos","beginDockDrag","r","moveDockDrag","endDockDrag","ensureBubble","dx","dy","nx","ny","clampBubbleToViewport","persistBubblePos","getStableWH","saveBubblePos","width","height","rw","rh","loadBubblePos","fromRatioToPx","fallback","bw","bh","useSaved","r0","size","amp","margin","_c","open","openQueue","list","opts","ids","start","prev","isActive","minimize","close","overlay","dialogEl","stageEl","imgEl","linkEl","closeBtn","backdropEl","isPanning","startX","startY","curX","curY","scale","baseW","baseH","stageW","stageH","activePointers","pinchActive","pinchBaseDist","pinchBaseScale","min","max","dist","midpoint","ensureZoom","bar","closeZoom","onWheel","toggleZoom","onPointerDown","onPointerMove","onPointerUpCancel","isZoomOpen","measureStage","applyTransform","measureBase","clampPan","contentW","contentH","maxX","maxY","openZoom","src","alt","doMeasure","newScale","pivot","center","factor","p1","p2","d","mid","detectBasePath","baseEl","viteBase","__vite_import_meta_env__","parts","BASE_URL","SPRITE","icon","cls","fmtTime","msLike","total","years","trackRow","title","link","ensureModalShell","doc","modal","createArtistModal","rootEl","modalBody","modalClose","dialog","player","scrollTopBtn","placeScrollTopHandler","onDialogScroll","onWinResize","ensureScrollTop","right","onEsc","zoomImg","render","artistId","artist","albums","img","country","members","sex","bio","genres","albumsMarkup","alb","tracks","openFor","spriteUrl","VIEW_KEY","DEFAULT_LIMIT","LIST_LIMIT","getSavedView","saveView","mode","initGrid","root","panel","toggleBtn","resetBtn","resetBtnSm","viewToggle","searchInput","searchBtn","ddSort","ddSortBtn","ddSortList","ddGenre","ddGenreBtn","ddGenreList","grid","pager","empty","modalApi","reqId","show","el","hide","isDesktop","byName","syncPanelMode","st","scrollToGridTop","applyEmpty","resetGridInlineStyles","buildSkeletonCard","renderSkeleton","count","afterImagesFadeIn","done","gridCleanupTimer","lockGridHeight","hh","unlockGridHeight","swapGridContent","renderFn","newH","onEnd","buildCard","about","tags","renderGrid","renderPager","totalPages","btn","label","dis","act","win","from","to","out","loadGenres","loadArtists","allowRetry","myId","q","server","closeDropdowns","except","dd","ul","toggleDropdown","li","doSearch","resetAll","sectionRoot","ensureViewToggle","anchor","applyView","listOn","parseQuery","buildQuery","initRouter","urlState","changed","lastQS","qs","url","cache","initPrefetch","hoverTimer","hoverId","schedulePrefetch","initArtists","uniq","shuffle","SEED_IDS","LS_KEY_POOL","LS_KEY_LAST","readPoolLS","savePoolLS","addToPoolLS","collectFromDOM","href","installCollector","mutations","added","buildPool","mem","dom","startMixRadio","pool","order","last","refs","openMenu","closeMenu","resolve","getHeaderOffset","applyScrollPadding","smoothScroll","targetHref","headerOffset","targetY","diff","t0","ease","step","ts","logo","navLinks","linkTargets","rawId","currentEl","setActiveByEl","lockUntil","LOCK_MS","isLocked","io","initScrollSpy","rootMargin","visibleRatio","entries","en","best","_","targetId","openBtn","form","container","inputName","inputMessage","scrollY","dataFromLocalStorage","createStars","rating","star","saveToLocalStorage","hoveredStar","savedRating","formRating","upTo","index","swiper","Swiper","dots","activateDot","dotNumber","dot","getDotIndex","dotElements","slideIndex","currentIndex","loadReviews","wrapper","feedback","stars","slide","starContainer","iziToast","savedData","resetLocalStorage","message","CLICKABLE_SELECTOR","IGNORE_SELECTOR","SFX"],"mappings":"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"}